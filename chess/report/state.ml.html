<html>
  <head>
    <title>Coverage report</title>
    <link rel="stylesheet" href="coverage.css" />
    <meta charset="utf-8" />
  </head>
  <body>
    <div id="header">
      <h1>
        <a href="index.html">
          <span class="dirname"></span>state.ml
        </a>
      </h1>
      <h2>96.43%</h2>
    </div>
    <div id="navbar">
      <span class="unvisited" style="top:40.70%"></span>
      <span class="unvisited" style="top:41.30%"></span>
      <span class="unvisited" style="top:41.43%"></span>
      <span class="unvisited" style="top:43.96%"></span>
      <span class="unvisited" style="top:44.57%"></span>
      <span class="unvisited" style="top:44.69%"></span>
      <span class="unvisited" style="top:72.83%"></span>
      <span class="unvisited" style="top:74.88%"></span>
      <span class="unvisited" style="top:75.00%"></span>
      <span class="unvisited" style="top:77.66%"></span>
      <span class="unvisited" style="top:80.31%"></span>
      <span class="unvisited" style="top:81.28%"></span>
      <span class="unvisited" style="top:82.73%"></span>
      <span class="unvisited" style="top:82.85%"></span>
      <span class="unvisited" style="top:90.94%"></span>
      <span class="some-visited" style="top:91.06%"></span>
      <span class="some-visited" style="top:91.18%"></span>
      <span class="unvisited" style="top:91.67%"></span>
      <span class="some-visited" style="top:91.79%"></span>
      <span class="some-visited" style="top:91.91%"></span>
      <span class="unvisited" style="top:96.62%"></span>
      <span class="unvisited" style="top:99.40%"></span>
    </div>
    <div id="report">
      <div id="lines-layer">
        <pre>
<a id="L1"></a><span > </span>
<a id="L2"></a><span > </span>
<a id="L3"></a><span > </span>
<a id="L4"></a><span > </span>
<a id="L5"></a><span > </span>
<a id="L6"></a><span > </span>
<a id="L7"></a><span > </span>
<a id="L8"></a><span class="visited"> </span>
<a id="L9"></a><span class="visited"> </span>
<a id="L10"></a><span class="visited"> </span>
<a id="L11"></a><span class="visited"> </span>
<a id="L12"></a><span class="visited"> </span>
<a id="L13"></a><span class="visited"> </span>
<a id="L14"></a><span > </span>
<a id="L15"></a><span class="visited"> </span>
<a id="L16"></a><span > </span>
<a id="L17"></a><span > </span>
<a id="L18"></a><span class="visited"> </span>
<a id="L19"></a><span class="visited"> </span>
<a id="L20"></a><span class="visited"> </span>
<a id="L21"></a><span class="visited"> </span>
<a id="L22"></a><span class="visited"> </span>
<a id="L23"></a><span class="visited"> </span>
<a id="L24"></a><span > </span>
<a id="L25"></a><span class="visited"> </span>
<a id="L26"></a><span > </span>
<a id="L27"></a><span > </span>
<a id="L28"></a><span class="visited"> </span>
<a id="L29"></a><span class="visited"> </span>
<a id="L30"></a><span class="visited"> </span>
<a id="L31"></a><span class="visited"> </span>
<a id="L32"></a><span > </span>
<a id="L33"></a><span > </span>
<a id="L34"></a><span class="visited"> </span>
<a id="L35"></a><span > </span>
<a id="L36"></a><span > </span>
<a id="L37"></a><span class="visited"> </span>
<a id="L38"></a><span > </span>
<a id="L39"></a><span > </span>
<a id="L40"></a><span > </span>
<a id="L41"></a><span > </span>
<a id="L42"></a><span > </span>
<a id="L43"></a><span > </span>
<a id="L44"></a><span class="visited"> </span>
<a id="L45"></a><span class="visited"> </span>
<a id="L46"></a><span class="visited"> </span>
<a id="L47"></a><span class="visited"> </span>
<a id="L48"></a><span > </span>
<a id="L49"></a><span class="visited"> </span>
<a id="L50"></a><span > </span>
<a id="L51"></a><span > </span>
<a id="L52"></a><span > </span>
<a id="L53"></a><span > </span>
<a id="L54"></a><span class="visited"> </span>
<a id="L55"></a><span class="visited"> </span>
<a id="L56"></a><span class="visited"> </span>
<a id="L57"></a><span class="visited"> </span>
<a id="L58"></a><span > </span>
<a id="L59"></a><span class="visited"> </span>
<a id="L60"></a><span > </span>
<a id="L61"></a><span > </span>
<a id="L62"></a><span > </span>
<a id="L63"></a><span > </span>
<a id="L64"></a><span class="visited"> </span>
<a id="L65"></a><span class="visited"> </span>
<a id="L66"></a><span class="visited"> </span>
<a id="L67"></a><span class="visited"> </span>
<a id="L68"></a><span > </span>
<a id="L69"></a><span class="visited"> </span>
<a id="L70"></a><span > </span>
<a id="L71"></a><span > </span>
<a id="L72"></a><span > </span>
<a id="L73"></a><span > </span>
<a id="L74"></a><span class="visited"> </span>
<a id="L75"></a><span class="visited"> </span>
<a id="L76"></a><span class="visited"> </span>
<a id="L77"></a><span class="visited"> </span>
<a id="L78"></a><span class="visited"> </span>
<a id="L79"></a><span > </span>
<a id="L80"></a><span class="visited"> </span>
<a id="L81"></a><span > </span>
<a id="L82"></a><span > </span>
<a id="L83"></a><span > </span>
<a id="L84"></a><span > </span>
<a id="L85"></a><span class="visited"> </span>
<a id="L86"></a><span class="visited"> </span>
<a id="L87"></a><span class="visited"> </span>
<a id="L88"></a><span class="visited"> </span>
<a id="L89"></a><span class="visited"> </span>
<a id="L90"></a><span > </span>
<a id="L91"></a><span class="visited"> </span>
<a id="L92"></a><span > </span>
<a id="L93"></a><span > </span>
<a id="L94"></a><span > </span>
<a id="L95"></a><span class="visited"> </span>
<a id="L96"></a><span class="visited"> </span>
<a id="L97"></a><span class="visited"> </span>
<a id="L98"></a><span class="visited"> </span>
<a id="L99"></a><span class="visited"> </span>
<a id="L100"></a><span > </span>
<a id="L101"></a><span > </span>
<a id="L102"></a><span > </span>
<a id="L103"></a><span > </span>
<a id="L104"></a><span class="visited"> </span>
<a id="L105"></a><span class="visited"> </span>
<a id="L106"></a><span class="visited"> </span>
<a id="L107"></a><span class="visited"> </span>
<a id="L108"></a><span class="visited"> </span>
<a id="L109"></a><span > </span>
<a id="L110"></a><span > </span>
<a id="L111"></a><span > </span>
<a id="L112"></a><span class="visited"> </span>
<a id="L113"></a><span class="visited"> </span>
<a id="L114"></a><span class="visited"> </span>
<a id="L115"></a><span > </span>
<a id="L116"></a><span > </span>
<a id="L117"></a><span > </span>
<a id="L118"></a><span > </span>
<a id="L119"></a><span class="visited"> </span>
<a id="L120"></a><span class="visited"> </span>
<a id="L121"></a><span class="visited"> </span>
<a id="L122"></a><span > </span>
<a id="L123"></a><span > </span>
<a id="L124"></a><span > </span>
<a id="L125"></a><span > </span>
<a id="L126"></a><span > </span>
<a id="L127"></a><span > </span>
<a id="L128"></a><span class="visited"> </span>
<a id="L129"></a><span class="visited"> </span>
<a id="L130"></a><span class="visited"> </span>
<a id="L131"></a><span > </span>
<a id="L132"></a><span > </span>
<a id="L133"></a><span > </span>
<a id="L134"></a><span > </span>
<a id="L135"></a><span > </span>
<a id="L136"></a><span > </span>
<a id="L137"></a><span class="visited"> </span>
<a id="L138"></a><span class="visited"> </span>
<a id="L139"></a><span class="visited"> </span>
<a id="L140"></a><span > </span>
<a id="L141"></a><span > </span>
<a id="L142"></a><span > </span>
<a id="L143"></a><span > </span>
<a id="L144"></a><span > </span>
<a id="L145"></a><span > </span>
<a id="L146"></a><span class="visited"> </span>
<a id="L147"></a><span class="visited"> </span>
<a id="L148"></a><span class="visited"> </span>
<a id="L149"></a><span > </span>
<a id="L150"></a><span > </span>
<a id="L151"></a><span > </span>
<a id="L152"></a><span > </span>
<a id="L153"></a><span > </span>
<a id="L154"></a><span class="visited"> </span>
<a id="L155"></a><span class="visited"> </span>
<a id="L156"></a><span class="visited"> </span>
<a id="L157"></a><span class="visited"> </span>
<a id="L158"></a><span class="visited"> </span>
<a id="L159"></a><span > </span>
<a id="L160"></a><span > </span>
<a id="L161"></a><span > </span>
<a id="L162"></a><span > </span>
<a id="L163"></a><span class="visited"> </span>
<a id="L164"></a><span class="visited"> </span>
<a id="L165"></a><span class="visited"> </span>
<a id="L166"></a><span class="visited"> </span>
<a id="L167"></a><span class="visited"> </span>
<a id="L168"></a><span > </span>
<a id="L169"></a><span > </span>
<a id="L170"></a><span > </span>
<a id="L171"></a><span class="visited"> </span>
<a id="L172"></a><span class="visited"> </span>
<a id="L173"></a><span class="visited"> </span>
<a id="L174"></a><span > </span>
<a id="L175"></a><span > </span>
<a id="L176"></a><span > </span>
<a id="L177"></a><span > </span>
<a id="L178"></a><span class="visited"> </span>
<a id="L179"></a><span class="visited"> </span>
<a id="L180"></a><span class="visited"> </span>
<a id="L181"></a><span > </span>
<a id="L182"></a><span > </span>
<a id="L183"></a><span > </span>
<a id="L184"></a><span > </span>
<a id="L185"></a><span > </span>
<a id="L186"></a><span > </span>
<a id="L187"></a><span class="visited"> </span>
<a id="L188"></a><span class="visited"> </span>
<a id="L189"></a><span class="visited"> </span>
<a id="L190"></a><span > </span>
<a id="L191"></a><span > </span>
<a id="L192"></a><span > </span>
<a id="L193"></a><span > </span>
<a id="L194"></a><span > </span>
<a id="L195"></a><span > </span>
<a id="L196"></a><span class="visited"> </span>
<a id="L197"></a><span class="visited"> </span>
<a id="L198"></a><span class="visited"> </span>
<a id="L199"></a><span > </span>
<a id="L200"></a><span > </span>
<a id="L201"></a><span > </span>
<a id="L202"></a><span > </span>
<a id="L203"></a><span > </span>
<a id="L204"></a><span > </span>
<a id="L205"></a><span class="visited"> </span>
<a id="L206"></a><span class="visited"> </span>
<a id="L207"></a><span class="visited"> </span>
<a id="L208"></a><span > </span>
<a id="L209"></a><span > </span>
<a id="L210"></a><span > </span>
<a id="L211"></a><span > </span>
<a id="L212"></a><span > </span>
<a id="L213"></a><span > </span>
<a id="L214"></a><span > </span>
<a id="L215"></a><span class="visited"> </span>
<a id="L216"></a><span class="visited"> </span>
<a id="L217"></a><span class="visited"> </span>
<a id="L218"></a><span class="visited"> </span>
<a id="L219"></a><span class="visited"> </span>
<a id="L220"></a><span class="visited"> </span>
<a id="L221"></a><span class="visited"> </span>
<a id="L222"></a><span > </span>
<a id="L223"></a><span > </span>
<a id="L224"></a><span > </span>
<a id="L225"></a><span > </span>
<a id="L226"></a><span class="visited"> </span>
<a id="L227"></a><span class="visited"> </span>
<a id="L228"></a><span class="visited"> </span>
<a id="L229"></a><span > </span>
<a id="L230"></a><span > </span>
<a id="L231"></a><span > </span>
<a id="L232"></a><span > </span>
<a id="L233"></a><span class="visited"> </span>
<a id="L234"></a><span class="visited"> </span>
<a id="L235"></a><span class="visited"> </span>
<a id="L236"></a><span > </span>
<a id="L237"></a><span > </span>
<a id="L238"></a><span > </span>
<a id="L239"></a><span > </span>
<a id="L240"></a><span > </span>
<a id="L241"></a><span > </span>
<a id="L242"></a><span class="visited"> </span>
<a id="L243"></a><span class="visited"> </span>
<a id="L244"></a><span class="visited"> </span>
<a id="L245"></a><span > </span>
<a id="L246"></a><span > </span>
<a id="L247"></a><span > </span>
<a id="L248"></a><span > </span>
<a id="L249"></a><span > </span>
<a id="L250"></a><span > </span>
<a id="L251"></a><span class="visited"> </span>
<a id="L252"></a><span class="visited"> </span>
<a id="L253"></a><span class="visited"> </span>
<a id="L254"></a><span > </span>
<a id="L255"></a><span > </span>
<a id="L256"></a><span > </span>
<a id="L257"></a><span > </span>
<a id="L258"></a><span > </span>
<a id="L259"></a><span > </span>
<a id="L260"></a><span class="visited"> </span>
<a id="L261"></a><span class="visited"> </span>
<a id="L262"></a><span class="visited"> </span>
<a id="L263"></a><span > </span>
<a id="L264"></a><span > </span>
<a id="L265"></a><span > </span>
<a id="L266"></a><span > </span>
<a id="L267"></a><span > </span>
<a id="L268"></a><span > </span>
<a id="L269"></a><span class="visited"> </span>
<a id="L270"></a><span class="visited"> </span>
<a id="L271"></a><span class="visited"> </span>
<a id="L272"></a><span class="visited"> </span>
<a id="L273"></a><span class="visited"> </span>
<a id="L274"></a><span class="visited"> </span>
<a id="L275"></a><span class="visited"> </span>
<a id="L276"></a><span > </span>
<a id="L277"></a><span > </span>
<a id="L278"></a><span > </span>
<a id="L279"></a><span > </span>
<a id="L280"></a><span class="visited"> </span>
<a id="L281"></a><span class="visited"> </span>
<a id="L282"></a><span class="visited"> </span>
<a id="L283"></a><span > </span>
<a id="L284"></a><span > </span>
<a id="L285"></a><span > </span>
<a id="L286"></a><span > </span>
<a id="L287"></a><span class="visited"> </span>
<a id="L288"></a><span class="visited"> </span>
<a id="L289"></a><span class="visited"> </span>
<a id="L290"></a><span > </span>
<a id="L291"></a><span > </span>
<a id="L292"></a><span > </span>
<a id="L293"></a><span > </span>
<a id="L294"></a><span > </span>
<a id="L295"></a><span > </span>
<a id="L296"></a><span class="visited"> </span>
<a id="L297"></a><span class="visited"> </span>
<a id="L298"></a><span class="visited"> </span>
<a id="L299"></a><span > </span>
<a id="L300"></a><span > </span>
<a id="L301"></a><span > </span>
<a id="L302"></a><span > </span>
<a id="L303"></a><span > </span>
<a id="L304"></a><span > </span>
<a id="L305"></a><span class="visited"> </span>
<a id="L306"></a><span class="visited"> </span>
<a id="L307"></a><span class="visited"> </span>
<a id="L308"></a><span > </span>
<a id="L309"></a><span > </span>
<a id="L310"></a><span > </span>
<a id="L311"></a><span > </span>
<a id="L312"></a><span > </span>
<a id="L313"></a><span > </span>
<a id="L314"></a><span class="visited"> </span>
<a id="L315"></a><span class="visited"> </span>
<a id="L316"></a><span class="visited"> </span>
<a id="L317"></a><span > </span>
<a id="L318"></a><span > </span>
<a id="L319"></a><span > </span>
<a id="L320"></a><span > </span>
<a id="L321"></a><span > </span>
<a id="L322"></a><span > </span>
<a id="L323"></a><span > </span>
<a id="L324"></a><span > </span>
<a id="L325"></a><span > </span>
<a id="L326"></a><span > </span>
<a id="L327"></a><span > </span>
<a id="L328"></a><span class="visited"> </span>
<a id="L329"></a><span class="visited"> </span>
<a id="L330"></a><span class="visited"> </span>
<a id="L331"></a><span class="visited"> </span>
<a id="L332"></a><span class="visited"> </span>
<a id="L333"></a><span class="visited"> </span>
<a id="L334"></a><span class="visited"> </span>
<a id="L335"></a><span class="visited"> </span>
<a id="L336"></a><span class="visited"> </span>
<a id="L337"></a><span class="unvisited"> </span>
<a id="L338"></a><span class="visited"> </span>
<a id="L339"></a><span class="visited"> </span>
<a id="L340"></a><span class="visited"> </span>
<a id="L341"></a><span class="visited"> </span>
<a id="L342"></a><span class="unvisited"> </span>
<a id="L343"></a><span class="unvisited"> </span>
<a id="L344"></a><span class="visited"> </span>
<a id="L345"></a><span > </span>
<a id="L346"></a><span > </span>
<a id="L347"></a><span > </span>
<a id="L348"></a><span > </span>
<a id="L349"></a><span > </span>
<a id="L350"></a><span > </span>
<a id="L351"></a><span > </span>
<a id="L352"></a><span > </span>
<a id="L353"></a><span > </span>
<a id="L354"></a><span class="visited"> </span>
<a id="L355"></a><span class="visited"> </span>
<a id="L356"></a><span class="visited"> </span>
<a id="L357"></a><span class="visited"> </span>
<a id="L358"></a><span class="visited"> </span>
<a id="L359"></a><span class="visited"> </span>
<a id="L360"></a><span class="visited"> </span>
<a id="L361"></a><span class="visited"> </span>
<a id="L362"></a><span class="visited"> </span>
<a id="L363"></a><span class="visited"> </span>
<a id="L364"></a><span class="unvisited"> </span>
<a id="L365"></a><span class="visited"> </span>
<a id="L366"></a><span class="visited"> </span>
<a id="L367"></a><span class="visited"> </span>
<a id="L368"></a><span class="visited"> </span>
<a id="L369"></a><span class="unvisited"> </span>
<a id="L370"></a><span class="unvisited"> </span>
<a id="L371"></a><span class="visited"> </span>
<a id="L372"></a><span > </span>
<a id="L373"></a><span > </span>
<a id="L374"></a><span > </span>
<a id="L375"></a><span > </span>
<a id="L376"></a><span > </span>
<a id="L377"></a><span > </span>
<a id="L378"></a><span > </span>
<a id="L379"></a><span class="visited"> </span>
<a id="L380"></a><span class="visited"> </span>
<a id="L381"></a><span class="visited"> </span>
<a id="L382"></a><span class="visited"> </span>
<a id="L383"></a><span class="visited"> </span>
<a id="L384"></a><span > </span>
<a id="L385"></a><span > </span>
<a id="L386"></a><span > </span>
<a id="L387"></a><span > </span>
<a id="L388"></a><span > </span>
<a id="L389"></a><span > </span>
<a id="L390"></a><span > </span>
<a id="L391"></a><span > </span>
<a id="L392"></a><span > </span>
<a id="L393"></a><span > </span>
<a id="L394"></a><span > </span>
<a id="L395"></a><span > </span>
<a id="L396"></a><span > </span>
<a id="L397"></a><span > </span>
<a id="L398"></a><span > </span>
<a id="L399"></a><span class="visited"> </span>
<a id="L400"></a><span class="visited"> </span>
<a id="L401"></a><span class="visited"> </span>
<a id="L402"></a><span class="visited"> </span>
<a id="L403"></a><span class="visited"> </span>
<a id="L404"></a><span class="visited"> </span>
<a id="L405"></a><span class="visited"> </span>
<a id="L406"></a><span class="visited"> </span>
<a id="L407"></a><span > </span>
<a id="L408"></a><span class="visited"> </span>
<a id="L409"></a><span class="visited"> </span>
<a id="L410"></a><span > </span>
<a id="L411"></a><span class="visited"> </span>
<a id="L412"></a><span class="visited"> </span>
<a id="L413"></a><span > </span>
<a id="L414"></a><span > </span>
<a id="L415"></a><span class="visited"> </span>
<a id="L416"></a><span > </span>
<a id="L417"></a><span > </span>
<a id="L418"></a><span class="visited"> </span>
<a id="L419"></a><span > </span>
<a id="L420"></a><span > </span>
<a id="L421"></a><span > </span>
<a id="L422"></a><span > </span>
<a id="L423"></a><span > </span>
<a id="L424"></a><span class="visited"> </span>
<a id="L425"></a><span class="visited"> </span>
<a id="L426"></a><span class="visited"> </span>
<a id="L427"></a><span > </span>
<a id="L428"></a><span > </span>
<a id="L429"></a><span > </span>
<a id="L430"></a><span > </span>
<a id="L431"></a><span > </span>
<a id="L432"></a><span > </span>
<a id="L433"></a><span > </span>
<a id="L434"></a><span > </span>
<a id="L435"></a><span > </span>
<a id="L436"></a><span class="visited"> </span>
<a id="L437"></a><span class="visited"> </span>
<a id="L438"></a><span class="visited"> </span>
<a id="L439"></a><span class="visited"> </span>
<a id="L440"></a><span class="visited"> </span>
<a id="L441"></a><span > </span>
<a id="L442"></a><span > </span>
<a id="L443"></a><span > </span>
<a id="L444"></a><span > </span>
<a id="L445"></a><span > </span>
<a id="L446"></a><span > </span>
<a id="L447"></a><span class="visited"> </span>
<a id="L448"></a><span class="visited"> </span>
<a id="L449"></a><span class="visited"> </span>
<a id="L450"></a><span class="visited"> </span>
<a id="L451"></a><span class="visited"> </span>
<a id="L452"></a><span class="visited"> </span>
<a id="L453"></a><span class="visited"> </span>
<a id="L454"></a><span class="visited"> </span>
<a id="L455"></a><span > </span>
<a id="L456"></a><span class="visited"> </span>
<a id="L457"></a><span class="visited"> </span>
<a id="L458"></a><span > </span>
<a id="L459"></a><span class="visited"> </span>
<a id="L460"></a><span class="visited"> </span>
<a id="L461"></a><span > </span>
<a id="L462"></a><span > </span>
<a id="L463"></a><span class="visited"> </span>
<a id="L464"></a><span > </span>
<a id="L465"></a><span > </span>
<a id="L466"></a><span class="visited"> </span>
<a id="L467"></a><span > </span>
<a id="L468"></a><span > </span>
<a id="L469"></a><span > </span>
<a id="L470"></a><span > </span>
<a id="L471"></a><span > </span>
<a id="L472"></a><span > </span>
<a id="L473"></a><span > </span>
<a id="L474"></a><span > </span>
<a id="L475"></a><span > </span>
<a id="L476"></a><span > </span>
<a id="L477"></a><span > </span>
<a id="L478"></a><span > </span>
<a id="L479"></a><span > </span>
<a id="L480"></a><span > </span>
<a id="L481"></a><span > </span>
<a id="L482"></a><span class="visited"> </span>
<a id="L483"></a><span class="visited"> </span>
<a id="L484"></a><span class="visited"> </span>
<a id="L485"></a><span > </span>
<a id="L486"></a><span > </span>
<a id="L487"></a><span > </span>
<a id="L488"></a><span > </span>
<a id="L489"></a><span > </span>
<a id="L490"></a><span class="visited"> </span>
<a id="L491"></a><span class="visited"> </span>
<a id="L492"></a><span class="visited"> </span>
<a id="L493"></a><span class="visited"> </span>
<a id="L494"></a><span class="visited"> </span>
<a id="L495"></a><span > </span>
<a id="L496"></a><span > </span>
<a id="L497"></a><span > </span>
<a id="L498"></a><span > </span>
<a id="L499"></a><span > </span>
<a id="L500"></a><span class="visited"> </span>
<a id="L501"></a><span class="visited"> </span>
<a id="L502"></a><span class="visited"> </span>
<a id="L503"></a><span class="visited"> </span>
<a id="L504"></a><span class="visited"> </span>
<a id="L505"></a><span class="visited"> </span>
<a id="L506"></a><span class="visited"> </span>
<a id="L507"></a><span > </span>
<a id="L508"></a><span class="visited"> </span>
<a id="L509"></a><span class="visited"> </span>
<a id="L510"></a><span class="visited"> </span>
<a id="L511"></a><span class="visited"> </span>
<a id="L512"></a><span class="visited"> </span>
<a id="L513"></a><span > </span>
<a id="L514"></a><span class="visited"> </span>
<a id="L515"></a><span > </span>
<a id="L516"></a><span class="visited"> </span>
<a id="L517"></a><span > </span>
<a id="L518"></a><span > </span>
<a id="L519"></a><span > </span>
<a id="L520"></a><span > </span>
<a id="L521"></a><span class="visited"> </span>
<a id="L522"></a><span class="visited"> </span>
<a id="L523"></a><span class="visited"> </span>
<a id="L524"></a><span > </span>
<a id="L525"></a><span > </span>
<a id="L526"></a><span > </span>
<a id="L527"></a><span > </span>
<a id="L528"></a><span > </span>
<a id="L529"></a><span > </span>
<a id="L530"></a><span > </span>
<a id="L531"></a><span > </span>
<a id="L532"></a><span class="visited"> </span>
<a id="L533"></a><span class="visited"> </span>
<a id="L534"></a><span class="visited"> </span>
<a id="L535"></a><span class="visited"> </span>
<a id="L536"></a><span class="visited"> </span>
<a id="L537"></a><span class="visited"> </span>
<a id="L538"></a><span > </span>
<a id="L539"></a><span class="visited"> </span>
<a id="L540"></a><span class="visited"> </span>
<a id="L541"></a><span class="visited"> </span>
<a id="L542"></a><span class="visited"> </span>
<a id="L543"></a><span class="visited"> </span>
<a id="L544"></a><span class="visited"> </span>
<a id="L545"></a><span class="visited"> </span>
<a id="L546"></a><span class="visited"> </span>
<a id="L547"></a><span class="visited"> </span>
<a id="L548"></a><span class="visited"> </span>
<a id="L549"></a><span class="visited"> </span>
<a id="L550"></a><span > </span>
<a id="L551"></a><span class="visited"> </span>
<a id="L552"></a><span > </span>
<a id="L553"></a><span > </span>
<a id="L554"></a><span > </span>
<a id="L555"></a><span > </span>
<a id="L556"></a><span class="visited"> </span>
<a id="L557"></a><span class="visited"> </span>
<a id="L558"></a><span class="visited"> </span>
<a id="L559"></a><span > </span>
<a id="L560"></a><span > </span>
<a id="L561"></a><span > </span>
<a id="L562"></a><span > </span>
<a id="L563"></a><span > </span>
<a id="L564"></a><span > </span>
<a id="L565"></a><span > </span>
<a id="L566"></a><span class="visited"> </span>
<a id="L567"></a><span > </span>
<a id="L568"></a><span > </span>
<a id="L569"></a><span > </span>
<a id="L570"></a><span > </span>
<a id="L571"></a><span > </span>
<a id="L572"></a><span > </span>
<a id="L573"></a><span class="visited"> </span>
<a id="L574"></a><span > </span>
<a id="L575"></a><span > </span>
<a id="L576"></a><span > </span>
<a id="L577"></a><span > </span>
<a id="L578"></a><span class="visited"> </span>
<a id="L579"></a><span > </span>
<a id="L580"></a><span > </span>
<a id="L581"></a><span > </span>
<a id="L582"></a><span > </span>
<a id="L583"></a><span class="visited"> </span>
<a id="L584"></a><span > </span>
<a id="L585"></a><span > </span>
<a id="L586"></a><span > </span>
<a id="L587"></a><span > </span>
<a id="L588"></a><span > </span>
<a id="L589"></a><span > </span>
<a id="L590"></a><span > </span>
<a id="L591"></a><span > </span>
<a id="L592"></a><span > </span>
<a id="L593"></a><span > </span>
<a id="L594"></a><span class="visited"> </span>
<a id="L595"></a><span class="visited"> </span>
<a id="L596"></a><span class="visited"> </span>
<a id="L597"></a><span class="visited"> </span>
<a id="L598"></a><span class="visited"> </span>
<a id="L599"></a><span class="visited"> </span>
<a id="L600"></a><span class="visited"> </span>
<a id="L601"></a><span class="visited"> </span>
<a id="L602"></a><span class="visited"> </span>
<a id="L603"></a><span class="unvisited"> </span>
<a id="L604"></a><span class="visited"> </span>
<a id="L605"></a><span > </span>
<a id="L606"></a><span > </span>
<a id="L607"></a><span > </span>
<a id="L608"></a><span > </span>
<a id="L609"></a><span > </span>
<a id="L610"></a><span > </span>
<a id="L611"></a><span > </span>
<a id="L612"></a><span class="visited"> </span>
<a id="L613"></a><span class="visited"> </span>
<a id="L614"></a><span class="visited"> </span>
<a id="L615"></a><span class="visited"> </span>
<a id="L616"></a><span class="visited"> </span>
<a id="L617"></a><span class="visited"> </span>
<a id="L618"></a><span class="visited"> </span>
<a id="L619"></a><span class="visited"> </span>
<a id="L620"></a><span class="unvisited"> </span>
<a id="L621"></a><span class="unvisited"> </span>
<a id="L622"></a><span class="visited"> </span>
<a id="L623"></a><span > </span>
<a id="L624"></a><span > </span>
<a id="L625"></a><span > </span>
<a id="L626"></a><span > </span>
<a id="L627"></a><span > </span>
<a id="L628"></a><span > </span>
<a id="L629"></a><span > </span>
<a id="L630"></a><span class="visited"> </span>
<a id="L631"></a><span class="visited"> </span>
<a id="L632"></a><span class="visited"> </span>
<a id="L633"></a><span class="visited"> </span>
<a id="L634"></a><span class="visited"> </span>
<a id="L635"></a><span class="visited"> </span>
<a id="L636"></a><span class="visited"> </span>
<a id="L637"></a><span class="visited"> </span>
<a id="L638"></a><span class="visited"> </span>
<a id="L639"></a><span class="visited"> </span>
<a id="L640"></a><span class="visited"> </span>
<a id="L641"></a><span class="visited"> </span>
<a id="L642"></a><span class="visited"> </span>
<a id="L643"></a><span class="unvisited"> </span>
<a id="L644"></a><span class="visited"> </span>
<a id="L645"></a><span > </span>
<a id="L646"></a><span > </span>
<a id="L647"></a><span > </span>
<a id="L648"></a><span > </span>
<a id="L649"></a><span > </span>
<a id="L650"></a><span > </span>
<a id="L651"></a><span > </span>
<a id="L652"></a><span class="visited"> </span>
<a id="L653"></a><span class="visited"> </span>
<a id="L654"></a><span class="visited"> </span>
<a id="L655"></a><span class="visited"> </span>
<a id="L656"></a><span class="visited"> </span>
<a id="L657"></a><span class="visited"> </span>
<a id="L658"></a><span class="visited"> </span>
<a id="L659"></a><span class="visited"> </span>
<a id="L660"></a><span class="visited"> </span>
<a id="L661"></a><span class="visited"> </span>
<a id="L662"></a><span class="visited"> </span>
<a id="L663"></a><span class="visited"> </span>
<a id="L664"></a><span class="visited"> </span>
<a id="L665"></a><span class="unvisited"> </span>
<a id="L666"></a><span class="visited"> </span>
<a id="L667"></a><span > </span>
<a id="L668"></a><span > </span>
<a id="L669"></a><span > </span>
<a id="L670"></a><span > </span>
<a id="L671"></a><span class="visited"> </span>
<a id="L672"></a><span class="visited"> </span>
<a id="L673"></a><span class="unvisited"> </span>
<a id="L674"></a><span class="visited"> </span>
<a id="L675"></a><span > </span>
<a id="L676"></a><span class="visited"> </span>
<a id="L677"></a><span class="visited"> </span>
<a id="L678"></a><span class="visited"> </span>
<a id="L679"></a><span > </span>
<a id="L680"></a><span > </span>
<a id="L681"></a><span > </span>
<a id="L682"></a><span > </span>
<a id="L683"></a><span > </span>
<a id="L684"></a><span > </span>
<a id="L685"></a><span class="unvisited"> </span>
<a id="L686"></a><span class="unvisited"> </span>
<a id="L687"></a><span > </span>
<a id="L688"></a><span > </span>
<a id="L689"></a><span > </span>
<a id="L690"></a><span > </span>
<a id="L691"></a><span class="visited"> </span>
<a id="L692"></a><span class="visited"> </span>
<a id="L693"></a><span class="visited"> </span>
<a id="L694"></a><span class="visited"> </span>
<a id="L695"></a><span class="visited"> </span>
<a id="L696"></a><span > </span>
<a id="L697"></a><span > </span>
<a id="L698"></a><span > </span>
<a id="L699"></a><span > </span>
<a id="L700"></a><span class="visited"> </span>
<a id="L701"></a><span class="visited"> </span>
<a id="L702"></a><span class="visited"> </span>
<a id="L703"></a><span class="visited"> </span>
<a id="L704"></a><span class="visited"> </span>
<a id="L705"></a><span > </span>
<a id="L706"></a><span > </span>
<a id="L707"></a><span > </span>
<a id="L708"></a><span > </span>
<a id="L709"></a><span > </span>
<a id="L710"></a><span > </span>
<a id="L711"></a><span > </span>
<a id="L712"></a><span class="visited"> </span>
<a id="L713"></a><span class="visited"> </span>
<a id="L714"></a><span class="visited"> </span>
<a id="L715"></a><span class="visited"> </span>
<a id="L716"></a><span class="visited"> </span>
<a id="L717"></a><span class="visited"> </span>
<a id="L718"></a><span class="visited"> </span>
<a id="L719"></a><span class="visited"> </span>
<a id="L720"></a><span class="visited"> </span>
<a id="L721"></a><span > </span>
<a id="L722"></a><span > </span>
<a id="L723"></a><span class="visited"> </span>
<a id="L724"></a><span > </span>
<a id="L725"></a><span > </span>
<a id="L726"></a><span > </span>
<a id="L727"></a><span class="visited"> </span>
<a id="L728"></a><span class="visited"> </span>
<a id="L729"></a><span class="visited"> </span>
<a id="L730"></a><span > </span>
<a id="L731"></a><span > </span>
<a id="L732"></a><span class="visited"> </span>
<a id="L733"></a><span > </span>
<a id="L734"></a><span > </span>
<a id="L735"></a><span > </span>
<a id="L736"></a><span class="visited"> </span>
<a id="L737"></a><span class="visited"> </span>
<a id="L738"></a><span class="visited"> </span>
<a id="L739"></a><span > </span>
<a id="L740"></a><span > </span>
<a id="L741"></a><span > </span>
<a id="L742"></a><span > </span>
<a id="L743"></a><span > </span>
<a id="L744"></a><span > </span>
<a id="L745"></a><span class="visited"> </span>
<a id="L746"></a><span class="visited"> </span>
<a id="L747"></a><span class="visited"> </span>
<a id="L748"></a><span class="visited"> </span>
<a id="L749"></a><span class="visited"> </span>
<a id="L750"></a><span class="visited"> </span>
<a id="L751"></a><span class="visited"> </span>
<a id="L752"></a><span class="visited"> </span>
<a id="L753"></a><span class="unvisited"> </span>
<a id="L754"></a><span class="some-visited"> </span>
<a id="L755"></a><span class="some-visited"> </span>
<a id="L756"></a><span class="visited"> </span>
<a id="L757"></a><span > </span>
<a id="L758"></a><span class="visited"> </span>
<a id="L759"></a><span class="unvisited"> </span>
<a id="L760"></a><span class="some-visited"> </span>
<a id="L761"></a><span class="some-visited"> </span>
<a id="L762"></a><span class="visited"> </span>
<a id="L763"></a><span > </span>
<a id="L764"></a><span > </span>
<a id="L765"></a><span > </span>
<a id="L766"></a><span > </span>
<a id="L767"></a><span > </span>
<a id="L768"></a><span > </span>
<a id="L769"></a><span > </span>
<a id="L770"></a><span > </span>
<a id="L771"></a><span > </span>
<a id="L772"></a><span > </span>
<a id="L773"></a><span class="visited"> </span>
<a id="L774"></a><span class="visited"> </span>
<a id="L775"></a><span class="visited"> </span>
<a id="L776"></a><span class="visited"> </span>
<a id="L777"></a><span class="visited"> </span>
<a id="L778"></a><span > </span>
<a id="L779"></a><span > </span>
<a id="L780"></a><span > </span>
<a id="L781"></a><span > </span>
<a id="L782"></a><span > </span>
<a id="L783"></a><span > </span>
<a id="L784"></a><span > </span>
<a id="L785"></a><span class="visited"> </span>
<a id="L786"></a><span class="visited"> </span>
<a id="L787"></a><span class="visited"> </span>
<a id="L788"></a><span class="visited"> </span>
<a id="L789"></a><span class="visited"> </span>
<a id="L790"></a><span class="visited"> </span>
<a id="L791"></a><span class="visited"> </span>
<a id="L792"></a><span class="visited"> </span>
<a id="L793"></a><span class="visited"> </span>
<a id="L794"></a><span class="visited"> </span>
<a id="L795"></a><span class="visited"> </span>
<a id="L796"></a><span class="visited"> </span>
<a id="L797"></a><span class="visited"> </span>
<a id="L798"></a><span class="visited"> </span>
<a id="L799"></a><span class="visited"> </span>
<a id="L800"></a><span class="unvisited"> </span>
<a id="L801"></a><span > </span>
<a id="L802"></a><span > </span>
<a id="L803"></a><span > </span>
<a id="L804"></a><span > </span>
<a id="L805"></a><span > </span>
<a id="L806"></a><span > </span>
<a id="L807"></a><span > </span>
<a id="L808"></a><span class="visited"> </span>
<a id="L809"></a><span class="visited"> </span>
<a id="L810"></a><span class="visited"> </span>
<a id="L811"></a><span class="visited"> </span>
<a id="L812"></a><span class="visited"> </span>
<a id="L813"></a><span class="visited"> </span>
<a id="L814"></a><span class="visited"> </span>
<a id="L815"></a><span class="visited"> </span>
<a id="L816"></a><span class="visited"> </span>
<a id="L817"></a><span class="visited"> </span>
<a id="L818"></a><span class="visited"> </span>
<a id="L819"></a><span class="visited"> </span>
<a id="L820"></a><span class="visited"> </span>
<a id="L821"></a><span class="visited"> </span>
<a id="L822"></a><span class="visited"> </span>
<a id="L823"></a><span class="unvisited"> </span>
<a id="L824"></a><span > </span>
<a id="L825"></a><span > </span>
<a id="L826"></a><span class="visited"> </span>
<a id="L827"></a><span class="visited"> </span>
<a id="L828"></a><span class="visited"> </span>
</pre>
      </div>
      <div id="text-layer">
        <pre id="line-numbers">
<a href="#L1">  1</a>
<a href="#L2">  2</a>
<a href="#L3">  3</a>
<a href="#L4">  4</a>
<a href="#L5">  5</a>
<a href="#L6">  6</a>
<a href="#L7">  7</a>
<a href="#L8">  8</a>
<a href="#L9">  9</a>
<a href="#L10"> 10</a>
<a href="#L11"> 11</a>
<a href="#L12"> 12</a>
<a href="#L13"> 13</a>
<a href="#L14"> 14</a>
<a href="#L15"> 15</a>
<a href="#L16"> 16</a>
<a href="#L17"> 17</a>
<a href="#L18"> 18</a>
<a href="#L19"> 19</a>
<a href="#L20"> 20</a>
<a href="#L21"> 21</a>
<a href="#L22"> 22</a>
<a href="#L23"> 23</a>
<a href="#L24"> 24</a>
<a href="#L25"> 25</a>
<a href="#L26"> 26</a>
<a href="#L27"> 27</a>
<a href="#L28"> 28</a>
<a href="#L29"> 29</a>
<a href="#L30"> 30</a>
<a href="#L31"> 31</a>
<a href="#L32"> 32</a>
<a href="#L33"> 33</a>
<a href="#L34"> 34</a>
<a href="#L35"> 35</a>
<a href="#L36"> 36</a>
<a href="#L37"> 37</a>
<a href="#L38"> 38</a>
<a href="#L39"> 39</a>
<a href="#L40"> 40</a>
<a href="#L41"> 41</a>
<a href="#L42"> 42</a>
<a href="#L43"> 43</a>
<a href="#L44"> 44</a>
<a href="#L45"> 45</a>
<a href="#L46"> 46</a>
<a href="#L47"> 47</a>
<a href="#L48"> 48</a>
<a href="#L49"> 49</a>
<a href="#L50"> 50</a>
<a href="#L51"> 51</a>
<a href="#L52"> 52</a>
<a href="#L53"> 53</a>
<a href="#L54"> 54</a>
<a href="#L55"> 55</a>
<a href="#L56"> 56</a>
<a href="#L57"> 57</a>
<a href="#L58"> 58</a>
<a href="#L59"> 59</a>
<a href="#L60"> 60</a>
<a href="#L61"> 61</a>
<a href="#L62"> 62</a>
<a href="#L63"> 63</a>
<a href="#L64"> 64</a>
<a href="#L65"> 65</a>
<a href="#L66"> 66</a>
<a href="#L67"> 67</a>
<a href="#L68"> 68</a>
<a href="#L69"> 69</a>
<a href="#L70"> 70</a>
<a href="#L71"> 71</a>
<a href="#L72"> 72</a>
<a href="#L73"> 73</a>
<a href="#L74"> 74</a>
<a href="#L75"> 75</a>
<a href="#L76"> 76</a>
<a href="#L77"> 77</a>
<a href="#L78"> 78</a>
<a href="#L79"> 79</a>
<a href="#L80"> 80</a>
<a href="#L81"> 81</a>
<a href="#L82"> 82</a>
<a href="#L83"> 83</a>
<a href="#L84"> 84</a>
<a href="#L85"> 85</a>
<a href="#L86"> 86</a>
<a href="#L87"> 87</a>
<a href="#L88"> 88</a>
<a href="#L89"> 89</a>
<a href="#L90"> 90</a>
<a href="#L91"> 91</a>
<a href="#L92"> 92</a>
<a href="#L93"> 93</a>
<a href="#L94"> 94</a>
<a href="#L95"> 95</a>
<a href="#L96"> 96</a>
<a href="#L97"> 97</a>
<a href="#L98"> 98</a>
<a href="#L99"> 99</a>
<a href="#L100">100</a>
<a href="#L101">101</a>
<a href="#L102">102</a>
<a href="#L103">103</a>
<a href="#L104">104</a>
<a href="#L105">105</a>
<a href="#L106">106</a>
<a href="#L107">107</a>
<a href="#L108">108</a>
<a href="#L109">109</a>
<a href="#L110">110</a>
<a href="#L111">111</a>
<a href="#L112">112</a>
<a href="#L113">113</a>
<a href="#L114">114</a>
<a href="#L115">115</a>
<a href="#L116">116</a>
<a href="#L117">117</a>
<a href="#L118">118</a>
<a href="#L119">119</a>
<a href="#L120">120</a>
<a href="#L121">121</a>
<a href="#L122">122</a>
<a href="#L123">123</a>
<a href="#L124">124</a>
<a href="#L125">125</a>
<a href="#L126">126</a>
<a href="#L127">127</a>
<a href="#L128">128</a>
<a href="#L129">129</a>
<a href="#L130">130</a>
<a href="#L131">131</a>
<a href="#L132">132</a>
<a href="#L133">133</a>
<a href="#L134">134</a>
<a href="#L135">135</a>
<a href="#L136">136</a>
<a href="#L137">137</a>
<a href="#L138">138</a>
<a href="#L139">139</a>
<a href="#L140">140</a>
<a href="#L141">141</a>
<a href="#L142">142</a>
<a href="#L143">143</a>
<a href="#L144">144</a>
<a href="#L145">145</a>
<a href="#L146">146</a>
<a href="#L147">147</a>
<a href="#L148">148</a>
<a href="#L149">149</a>
<a href="#L150">150</a>
<a href="#L151">151</a>
<a href="#L152">152</a>
<a href="#L153">153</a>
<a href="#L154">154</a>
<a href="#L155">155</a>
<a href="#L156">156</a>
<a href="#L157">157</a>
<a href="#L158">158</a>
<a href="#L159">159</a>
<a href="#L160">160</a>
<a href="#L161">161</a>
<a href="#L162">162</a>
<a href="#L163">163</a>
<a href="#L164">164</a>
<a href="#L165">165</a>
<a href="#L166">166</a>
<a href="#L167">167</a>
<a href="#L168">168</a>
<a href="#L169">169</a>
<a href="#L170">170</a>
<a href="#L171">171</a>
<a href="#L172">172</a>
<a href="#L173">173</a>
<a href="#L174">174</a>
<a href="#L175">175</a>
<a href="#L176">176</a>
<a href="#L177">177</a>
<a href="#L178">178</a>
<a href="#L179">179</a>
<a href="#L180">180</a>
<a href="#L181">181</a>
<a href="#L182">182</a>
<a href="#L183">183</a>
<a href="#L184">184</a>
<a href="#L185">185</a>
<a href="#L186">186</a>
<a href="#L187">187</a>
<a href="#L188">188</a>
<a href="#L189">189</a>
<a href="#L190">190</a>
<a href="#L191">191</a>
<a href="#L192">192</a>
<a href="#L193">193</a>
<a href="#L194">194</a>
<a href="#L195">195</a>
<a href="#L196">196</a>
<a href="#L197">197</a>
<a href="#L198">198</a>
<a href="#L199">199</a>
<a href="#L200">200</a>
<a href="#L201">201</a>
<a href="#L202">202</a>
<a href="#L203">203</a>
<a href="#L204">204</a>
<a href="#L205">205</a>
<a href="#L206">206</a>
<a href="#L207">207</a>
<a href="#L208">208</a>
<a href="#L209">209</a>
<a href="#L210">210</a>
<a href="#L211">211</a>
<a href="#L212">212</a>
<a href="#L213">213</a>
<a href="#L214">214</a>
<a href="#L215">215</a>
<a href="#L216">216</a>
<a href="#L217">217</a>
<a href="#L218">218</a>
<a href="#L219">219</a>
<a href="#L220">220</a>
<a href="#L221">221</a>
<a href="#L222">222</a>
<a href="#L223">223</a>
<a href="#L224">224</a>
<a href="#L225">225</a>
<a href="#L226">226</a>
<a href="#L227">227</a>
<a href="#L228">228</a>
<a href="#L229">229</a>
<a href="#L230">230</a>
<a href="#L231">231</a>
<a href="#L232">232</a>
<a href="#L233">233</a>
<a href="#L234">234</a>
<a href="#L235">235</a>
<a href="#L236">236</a>
<a href="#L237">237</a>
<a href="#L238">238</a>
<a href="#L239">239</a>
<a href="#L240">240</a>
<a href="#L241">241</a>
<a href="#L242">242</a>
<a href="#L243">243</a>
<a href="#L244">244</a>
<a href="#L245">245</a>
<a href="#L246">246</a>
<a href="#L247">247</a>
<a href="#L248">248</a>
<a href="#L249">249</a>
<a href="#L250">250</a>
<a href="#L251">251</a>
<a href="#L252">252</a>
<a href="#L253">253</a>
<a href="#L254">254</a>
<a href="#L255">255</a>
<a href="#L256">256</a>
<a href="#L257">257</a>
<a href="#L258">258</a>
<a href="#L259">259</a>
<a href="#L260">260</a>
<a href="#L261">261</a>
<a href="#L262">262</a>
<a href="#L263">263</a>
<a href="#L264">264</a>
<a href="#L265">265</a>
<a href="#L266">266</a>
<a href="#L267">267</a>
<a href="#L268">268</a>
<a href="#L269">269</a>
<a href="#L270">270</a>
<a href="#L271">271</a>
<a href="#L272">272</a>
<a href="#L273">273</a>
<a href="#L274">274</a>
<a href="#L275">275</a>
<a href="#L276">276</a>
<a href="#L277">277</a>
<a href="#L278">278</a>
<a href="#L279">279</a>
<a href="#L280">280</a>
<a href="#L281">281</a>
<a href="#L282">282</a>
<a href="#L283">283</a>
<a href="#L284">284</a>
<a href="#L285">285</a>
<a href="#L286">286</a>
<a href="#L287">287</a>
<a href="#L288">288</a>
<a href="#L289">289</a>
<a href="#L290">290</a>
<a href="#L291">291</a>
<a href="#L292">292</a>
<a href="#L293">293</a>
<a href="#L294">294</a>
<a href="#L295">295</a>
<a href="#L296">296</a>
<a href="#L297">297</a>
<a href="#L298">298</a>
<a href="#L299">299</a>
<a href="#L300">300</a>
<a href="#L301">301</a>
<a href="#L302">302</a>
<a href="#L303">303</a>
<a href="#L304">304</a>
<a href="#L305">305</a>
<a href="#L306">306</a>
<a href="#L307">307</a>
<a href="#L308">308</a>
<a href="#L309">309</a>
<a href="#L310">310</a>
<a href="#L311">311</a>
<a href="#L312">312</a>
<a href="#L313">313</a>
<a href="#L314">314</a>
<a href="#L315">315</a>
<a href="#L316">316</a>
<a href="#L317">317</a>
<a href="#L318">318</a>
<a href="#L319">319</a>
<a href="#L320">320</a>
<a href="#L321">321</a>
<a href="#L322">322</a>
<a href="#L323">323</a>
<a href="#L324">324</a>
<a href="#L325">325</a>
<a href="#L326">326</a>
<a href="#L327">327</a>
<a href="#L328">328</a>
<a href="#L329">329</a>
<a href="#L330">330</a>
<a href="#L331">331</a>
<a href="#L332">332</a>
<a href="#L333">333</a>
<a href="#L334">334</a>
<a href="#L335">335</a>
<a href="#L336">336</a>
<a href="#L337">337</a>
<a href="#L338">338</a>
<a href="#L339">339</a>
<a href="#L340">340</a>
<a href="#L341">341</a>
<a href="#L342">342</a>
<a href="#L343">343</a>
<a href="#L344">344</a>
<a href="#L345">345</a>
<a href="#L346">346</a>
<a href="#L347">347</a>
<a href="#L348">348</a>
<a href="#L349">349</a>
<a href="#L350">350</a>
<a href="#L351">351</a>
<a href="#L352">352</a>
<a href="#L353">353</a>
<a href="#L354">354</a>
<a href="#L355">355</a>
<a href="#L356">356</a>
<a href="#L357">357</a>
<a href="#L358">358</a>
<a href="#L359">359</a>
<a href="#L360">360</a>
<a href="#L361">361</a>
<a href="#L362">362</a>
<a href="#L363">363</a>
<a href="#L364">364</a>
<a href="#L365">365</a>
<a href="#L366">366</a>
<a href="#L367">367</a>
<a href="#L368">368</a>
<a href="#L369">369</a>
<a href="#L370">370</a>
<a href="#L371">371</a>
<a href="#L372">372</a>
<a href="#L373">373</a>
<a href="#L374">374</a>
<a href="#L375">375</a>
<a href="#L376">376</a>
<a href="#L377">377</a>
<a href="#L378">378</a>
<a href="#L379">379</a>
<a href="#L380">380</a>
<a href="#L381">381</a>
<a href="#L382">382</a>
<a href="#L383">383</a>
<a href="#L384">384</a>
<a href="#L385">385</a>
<a href="#L386">386</a>
<a href="#L387">387</a>
<a href="#L388">388</a>
<a href="#L389">389</a>
<a href="#L390">390</a>
<a href="#L391">391</a>
<a href="#L392">392</a>
<a href="#L393">393</a>
<a href="#L394">394</a>
<a href="#L395">395</a>
<a href="#L396">396</a>
<a href="#L397">397</a>
<a href="#L398">398</a>
<a href="#L399">399</a>
<a href="#L400">400</a>
<a href="#L401">401</a>
<a href="#L402">402</a>
<a href="#L403">403</a>
<a href="#L404">404</a>
<a href="#L405">405</a>
<a href="#L406">406</a>
<a href="#L407">407</a>
<a href="#L408">408</a>
<a href="#L409">409</a>
<a href="#L410">410</a>
<a href="#L411">411</a>
<a href="#L412">412</a>
<a href="#L413">413</a>
<a href="#L414">414</a>
<a href="#L415">415</a>
<a href="#L416">416</a>
<a href="#L417">417</a>
<a href="#L418">418</a>
<a href="#L419">419</a>
<a href="#L420">420</a>
<a href="#L421">421</a>
<a href="#L422">422</a>
<a href="#L423">423</a>
<a href="#L424">424</a>
<a href="#L425">425</a>
<a href="#L426">426</a>
<a href="#L427">427</a>
<a href="#L428">428</a>
<a href="#L429">429</a>
<a href="#L430">430</a>
<a href="#L431">431</a>
<a href="#L432">432</a>
<a href="#L433">433</a>
<a href="#L434">434</a>
<a href="#L435">435</a>
<a href="#L436">436</a>
<a href="#L437">437</a>
<a href="#L438">438</a>
<a href="#L439">439</a>
<a href="#L440">440</a>
<a href="#L441">441</a>
<a href="#L442">442</a>
<a href="#L443">443</a>
<a href="#L444">444</a>
<a href="#L445">445</a>
<a href="#L446">446</a>
<a href="#L447">447</a>
<a href="#L448">448</a>
<a href="#L449">449</a>
<a href="#L450">450</a>
<a href="#L451">451</a>
<a href="#L452">452</a>
<a href="#L453">453</a>
<a href="#L454">454</a>
<a href="#L455">455</a>
<a href="#L456">456</a>
<a href="#L457">457</a>
<a href="#L458">458</a>
<a href="#L459">459</a>
<a href="#L460">460</a>
<a href="#L461">461</a>
<a href="#L462">462</a>
<a href="#L463">463</a>
<a href="#L464">464</a>
<a href="#L465">465</a>
<a href="#L466">466</a>
<a href="#L467">467</a>
<a href="#L468">468</a>
<a href="#L469">469</a>
<a href="#L470">470</a>
<a href="#L471">471</a>
<a href="#L472">472</a>
<a href="#L473">473</a>
<a href="#L474">474</a>
<a href="#L475">475</a>
<a href="#L476">476</a>
<a href="#L477">477</a>
<a href="#L478">478</a>
<a href="#L479">479</a>
<a href="#L480">480</a>
<a href="#L481">481</a>
<a href="#L482">482</a>
<a href="#L483">483</a>
<a href="#L484">484</a>
<a href="#L485">485</a>
<a href="#L486">486</a>
<a href="#L487">487</a>
<a href="#L488">488</a>
<a href="#L489">489</a>
<a href="#L490">490</a>
<a href="#L491">491</a>
<a href="#L492">492</a>
<a href="#L493">493</a>
<a href="#L494">494</a>
<a href="#L495">495</a>
<a href="#L496">496</a>
<a href="#L497">497</a>
<a href="#L498">498</a>
<a href="#L499">499</a>
<a href="#L500">500</a>
<a href="#L501">501</a>
<a href="#L502">502</a>
<a href="#L503">503</a>
<a href="#L504">504</a>
<a href="#L505">505</a>
<a href="#L506">506</a>
<a href="#L507">507</a>
<a href="#L508">508</a>
<a href="#L509">509</a>
<a href="#L510">510</a>
<a href="#L511">511</a>
<a href="#L512">512</a>
<a href="#L513">513</a>
<a href="#L514">514</a>
<a href="#L515">515</a>
<a href="#L516">516</a>
<a href="#L517">517</a>
<a href="#L518">518</a>
<a href="#L519">519</a>
<a href="#L520">520</a>
<a href="#L521">521</a>
<a href="#L522">522</a>
<a href="#L523">523</a>
<a href="#L524">524</a>
<a href="#L525">525</a>
<a href="#L526">526</a>
<a href="#L527">527</a>
<a href="#L528">528</a>
<a href="#L529">529</a>
<a href="#L530">530</a>
<a href="#L531">531</a>
<a href="#L532">532</a>
<a href="#L533">533</a>
<a href="#L534">534</a>
<a href="#L535">535</a>
<a href="#L536">536</a>
<a href="#L537">537</a>
<a href="#L538">538</a>
<a href="#L539">539</a>
<a href="#L540">540</a>
<a href="#L541">541</a>
<a href="#L542">542</a>
<a href="#L543">543</a>
<a href="#L544">544</a>
<a href="#L545">545</a>
<a href="#L546">546</a>
<a href="#L547">547</a>
<a href="#L548">548</a>
<a href="#L549">549</a>
<a href="#L550">550</a>
<a href="#L551">551</a>
<a href="#L552">552</a>
<a href="#L553">553</a>
<a href="#L554">554</a>
<a href="#L555">555</a>
<a href="#L556">556</a>
<a href="#L557">557</a>
<a href="#L558">558</a>
<a href="#L559">559</a>
<a href="#L560">560</a>
<a href="#L561">561</a>
<a href="#L562">562</a>
<a href="#L563">563</a>
<a href="#L564">564</a>
<a href="#L565">565</a>
<a href="#L566">566</a>
<a href="#L567">567</a>
<a href="#L568">568</a>
<a href="#L569">569</a>
<a href="#L570">570</a>
<a href="#L571">571</a>
<a href="#L572">572</a>
<a href="#L573">573</a>
<a href="#L574">574</a>
<a href="#L575">575</a>
<a href="#L576">576</a>
<a href="#L577">577</a>
<a href="#L578">578</a>
<a href="#L579">579</a>
<a href="#L580">580</a>
<a href="#L581">581</a>
<a href="#L582">582</a>
<a href="#L583">583</a>
<a href="#L584">584</a>
<a href="#L585">585</a>
<a href="#L586">586</a>
<a href="#L587">587</a>
<a href="#L588">588</a>
<a href="#L589">589</a>
<a href="#L590">590</a>
<a href="#L591">591</a>
<a href="#L592">592</a>
<a href="#L593">593</a>
<a href="#L594">594</a>
<a href="#L595">595</a>
<a href="#L596">596</a>
<a href="#L597">597</a>
<a href="#L598">598</a>
<a href="#L599">599</a>
<a href="#L600">600</a>
<a href="#L601">601</a>
<a href="#L602">602</a>
<a href="#L603">603</a>
<a href="#L604">604</a>
<a href="#L605">605</a>
<a href="#L606">606</a>
<a href="#L607">607</a>
<a href="#L608">608</a>
<a href="#L609">609</a>
<a href="#L610">610</a>
<a href="#L611">611</a>
<a href="#L612">612</a>
<a href="#L613">613</a>
<a href="#L614">614</a>
<a href="#L615">615</a>
<a href="#L616">616</a>
<a href="#L617">617</a>
<a href="#L618">618</a>
<a href="#L619">619</a>
<a href="#L620">620</a>
<a href="#L621">621</a>
<a href="#L622">622</a>
<a href="#L623">623</a>
<a href="#L624">624</a>
<a href="#L625">625</a>
<a href="#L626">626</a>
<a href="#L627">627</a>
<a href="#L628">628</a>
<a href="#L629">629</a>
<a href="#L630">630</a>
<a href="#L631">631</a>
<a href="#L632">632</a>
<a href="#L633">633</a>
<a href="#L634">634</a>
<a href="#L635">635</a>
<a href="#L636">636</a>
<a href="#L637">637</a>
<a href="#L638">638</a>
<a href="#L639">639</a>
<a href="#L640">640</a>
<a href="#L641">641</a>
<a href="#L642">642</a>
<a href="#L643">643</a>
<a href="#L644">644</a>
<a href="#L645">645</a>
<a href="#L646">646</a>
<a href="#L647">647</a>
<a href="#L648">648</a>
<a href="#L649">649</a>
<a href="#L650">650</a>
<a href="#L651">651</a>
<a href="#L652">652</a>
<a href="#L653">653</a>
<a href="#L654">654</a>
<a href="#L655">655</a>
<a href="#L656">656</a>
<a href="#L657">657</a>
<a href="#L658">658</a>
<a href="#L659">659</a>
<a href="#L660">660</a>
<a href="#L661">661</a>
<a href="#L662">662</a>
<a href="#L663">663</a>
<a href="#L664">664</a>
<a href="#L665">665</a>
<a href="#L666">666</a>
<a href="#L667">667</a>
<a href="#L668">668</a>
<a href="#L669">669</a>
<a href="#L670">670</a>
<a href="#L671">671</a>
<a href="#L672">672</a>
<a href="#L673">673</a>
<a href="#L674">674</a>
<a href="#L675">675</a>
<a href="#L676">676</a>
<a href="#L677">677</a>
<a href="#L678">678</a>
<a href="#L679">679</a>
<a href="#L680">680</a>
<a href="#L681">681</a>
<a href="#L682">682</a>
<a href="#L683">683</a>
<a href="#L684">684</a>
<a href="#L685">685</a>
<a href="#L686">686</a>
<a href="#L687">687</a>
<a href="#L688">688</a>
<a href="#L689">689</a>
<a href="#L690">690</a>
<a href="#L691">691</a>
<a href="#L692">692</a>
<a href="#L693">693</a>
<a href="#L694">694</a>
<a href="#L695">695</a>
<a href="#L696">696</a>
<a href="#L697">697</a>
<a href="#L698">698</a>
<a href="#L699">699</a>
<a href="#L700">700</a>
<a href="#L701">701</a>
<a href="#L702">702</a>
<a href="#L703">703</a>
<a href="#L704">704</a>
<a href="#L705">705</a>
<a href="#L706">706</a>
<a href="#L707">707</a>
<a href="#L708">708</a>
<a href="#L709">709</a>
<a href="#L710">710</a>
<a href="#L711">711</a>
<a href="#L712">712</a>
<a href="#L713">713</a>
<a href="#L714">714</a>
<a href="#L715">715</a>
<a href="#L716">716</a>
<a href="#L717">717</a>
<a href="#L718">718</a>
<a href="#L719">719</a>
<a href="#L720">720</a>
<a href="#L721">721</a>
<a href="#L722">722</a>
<a href="#L723">723</a>
<a href="#L724">724</a>
<a href="#L725">725</a>
<a href="#L726">726</a>
<a href="#L727">727</a>
<a href="#L728">728</a>
<a href="#L729">729</a>
<a href="#L730">730</a>
<a href="#L731">731</a>
<a href="#L732">732</a>
<a href="#L733">733</a>
<a href="#L734">734</a>
<a href="#L735">735</a>
<a href="#L736">736</a>
<a href="#L737">737</a>
<a href="#L738">738</a>
<a href="#L739">739</a>
<a href="#L740">740</a>
<a href="#L741">741</a>
<a href="#L742">742</a>
<a href="#L743">743</a>
<a href="#L744">744</a>
<a href="#L745">745</a>
<a href="#L746">746</a>
<a href="#L747">747</a>
<a href="#L748">748</a>
<a href="#L749">749</a>
<a href="#L750">750</a>
<a href="#L751">751</a>
<a href="#L752">752</a>
<a href="#L753">753</a>
<a href="#L754">754</a>
<a href="#L755">755</a>
<a href="#L756">756</a>
<a href="#L757">757</a>
<a href="#L758">758</a>
<a href="#L759">759</a>
<a href="#L760">760</a>
<a href="#L761">761</a>
<a href="#L762">762</a>
<a href="#L763">763</a>
<a href="#L764">764</a>
<a href="#L765">765</a>
<a href="#L766">766</a>
<a href="#L767">767</a>
<a href="#L768">768</a>
<a href="#L769">769</a>
<a href="#L770">770</a>
<a href="#L771">771</a>
<a href="#L772">772</a>
<a href="#L773">773</a>
<a href="#L774">774</a>
<a href="#L775">775</a>
<a href="#L776">776</a>
<a href="#L777">777</a>
<a href="#L778">778</a>
<a href="#L779">779</a>
<a href="#L780">780</a>
<a href="#L781">781</a>
<a href="#L782">782</a>
<a href="#L783">783</a>
<a href="#L784">784</a>
<a href="#L785">785</a>
<a href="#L786">786</a>
<a href="#L787">787</a>
<a href="#L788">788</a>
<a href="#L789">789</a>
<a href="#L790">790</a>
<a href="#L791">791</a>
<a href="#L792">792</a>
<a href="#L793">793</a>
<a href="#L794">794</a>
<a href="#L795">795</a>
<a href="#L796">796</a>
<a href="#L797">797</a>
<a href="#L798">798</a>
<a href="#L799">799</a>
<a href="#L800">800</a>
<a href="#L801">801</a>
<a href="#L802">802</a>
<a href="#L803">803</a>
<a href="#L804">804</a>
<a href="#L805">805</a>
<a href="#L806">806</a>
<a href="#L807">807</a>
<a href="#L808">808</a>
<a href="#L809">809</a>
<a href="#L810">810</a>
<a href="#L811">811</a>
<a href="#L812">812</a>
<a href="#L813">813</a>
<a href="#L814">814</a>
<a href="#L815">815</a>
<a href="#L816">816</a>
<a href="#L817">817</a>
<a href="#L818">818</a>
<a href="#L819">819</a>
<a href="#L820">820</a>
<a href="#L821">821</a>
<a href="#L822">822</a>
<a href="#L823">823</a>
<a href="#L824">824</a>
<a href="#L825">825</a>
<a href="#L826">826</a>
<a href="#L827">827</a>
<a href="#L828">828</a>
</pre>
        <pre id="code">
(* Note: You may introduce new code anywhere in this file. *) 

(* TODO: replace [unit] with a type of your own design. *)
type t = {red_remain_chess : (Board.name*(int*int)) list; 
          black_remain_chess : (Board.name*(int*int)) list}

let init_red chesslst = 
  <span data-count="1">l</span>et rec helper chesslst acc = 
    <span data-count="33">m</span>atch chesslst with 
    | <span data-count="1">[</span>] -&gt; acc 
    | <span data-count="32">h</span>::t -&gt; if (Board.color_chess h)=Board.Red 
      then <span data-count="16">h</span>elper t (((Board.name_chess h), (Board.pos_chess h))::acc)
      else <span data-count="16">h</span>elper t acc
  in 
  <span data-count="1">h</span>elper chesslst []

let init_black chesslst = 
  <span data-count="1">l</span>et rec helper chesslst acc = 
    <span data-count="33">m</span>atch chesslst with 
    | <span data-count="1">[</span>] -&gt; acc 
    | <span data-count="32">h</span>::t -&gt; if (Board.color_chess h)=Board.Black 
      then <span data-count="16">h</span>elper t (((Board.name_chess h), (Board.pos_chess h))::acc)
      else <span data-count="16">h</span>elper t acc
  in 
  <span data-count="1">h</span>elper chesslst []

let init_state =
  <span data-count="1">l</span>et chesses = <span data-count="1">B</span>oard.chesses (Board.init_board) in 
  <span data-count="1">l</span>et red = <span data-count="1">i</span>nit_red chesses in 
  <span data-count="1">l</span>et black = <span data-count="1">i</span>nit_black chesses in 
  <span data-count="1">{</span>red_remain_chess = red; black_remain_chess=black}

let red_remain_chess st =
  <span data-count="6197">s</span>t.red_remain_chess

let black_remain_chess st =
  <span data-count="6313">s</span>t.black_remain_chess

type result = Legal of t | Illegal

exception InvalidChess of string

let pos_lst remain = 
  <span data-count="300">l</span>et rec helper remain acc = 
    <span data-count="5100">m</span>atch remain with 
    | <span data-count="300">[</span>] -&gt; acc
    | <span data-count="4800">h</span>::t -&gt; helper t (snd h::acc)
  in 
  <span data-count="300">h</span>elper remain []

(** [red_remian_chess_pos st] is a list of positions of remaining red chess 
    on board in state [st]. *)
let red_remain_pos st= 
  <span data-count="6137">l</span>et rec red_remian_chess_pos_help lst accu = 
    <span data-count="104329">m</span>atch lst with
    |<span data-count="6137">[</span>] -&gt; accu
    |<span data-count="98192">(</span>h1, h2)::t -&gt; red_remian_chess_pos_help t (h2::accu)
  in
  <span data-count="6137">r</span>ed_remian_chess_pos_help (red_remain_chess st) []

(** [black_remain_chess_pos st ]a list of positions of remaining black 
    chess on board in state [st]. *)
let black_remain_pos st = 
  <span data-count="6243">l</span>et rec black_remain_chess_help lst accu =
    <span data-count="106131">m</span>atch lst with
    |<span data-count="6243">[</span>] -&gt; accu
    |<span data-count="99888">(</span>h1, h2) ::t -&gt; black_remain_chess_help t (h2::accu)
  in
  <span data-count="6243">b</span>lack_remain_chess_help (black_remain_chess st) []

(** [occupied_by_red pos st] is true if the given position [pos] is occupied by 
    a red chess in state [st]. *)
let occupied_by_red pos st=
  <span data-count="6137">l</span>et rec occupied_by_red_help pos lst= 
    <span data-count="97765">m</span>atch lst with
    |<span data-count="5366">[</span>] -&gt; false
    |<span data-count="92399">(</span>a,b)::t -&gt; if <span data-count="92399">a</span> = (fst pos) &amp;&amp; <span data-count="10598">b</span> =(snd pos) then <span data-count="771">t</span>rue 
      else <span data-count="91628">o</span>ccupied_by_red_help pos t
  in
  <span data-count="6137">o</span>ccupied_by_red_help pos (red_remain_pos st)

(** [occupied_by_black pos st] is true if the given position [pos] is occupied 
    by a black chess in state [st]*)
let occupied_by_black pos st=
  <span data-count="6243">l</span>et rec occupied_by_black_help pos lst =
    <span data-count="99414">m</span>atch lst with 
    |<span data-count="5467">[</span>] -&gt; false
    |<span data-count="93947">(</span>a,b)::t -&gt; if <span data-count="93947">a</span> = (fst pos) &amp;&amp; <span data-count="10874">b</span> = (snd pos) then <span data-count="776">t</span>rue 
      else <span data-count="93171">o</span>ccupied_by_black_help pos t
  in
  <span data-count="6243">o</span>ccupied_by_black_help pos (black_remain_pos st)

(** [red_pao_fly lst accu st] is the list of positions red pao can fly to. *)
let rec red_pao_fly lst accu st=
  <span data-count="410">m</span>atch lst with
  |<span data-count="136">[</span>] -&gt; accu
  |<span data-count="274">h</span>::t -&gt; if (occupied_by_black h st) then <span data-count="73">(</span>h::accu) 
    else <span data-count="201">i</span>f (occupied_by_red h st) then <span data-count="27">a</span>ccu
    else <span data-count="174">r</span>ed_pao_fly t accu st

(** [red_pao_move_furthuer lst accu st] is the list of positions red pao can 
    move further to. *)
let rec red_pao_move_further lst accu st =
  <span data-count="1392">m</span>atch lst with
  |<span data-count="131">[</span>] -&gt; accu
  |<span data-count="1261">h</span>::t -&gt; if <span data-count="1261">(</span>occupied_by_black h st) || <span data-count="1160">(</span>occupied_by_red h st)
    then <span data-count="236">(</span>red_pao_fly t [] st) @ accu
    else <span data-count="1025">r</span>ed_pao_move_further t (h::accu) st

(** [red_pao_move_help lst st] is the helper function for moving red pao. *)
let red_pao_move_help lst st=
  <span data-count="372">m</span>atch lst with
  |<span data-count="5">[</span>] -&gt; []
  |<span data-count="367">h</span>::t -&gt; red_pao_move_further lst [] st

(** [red_pao_move_less_b] is the list of position that red pao can move to with
    the second pos index decreased. *)
let red_pao_move_less_b st pos = 
  <span data-count="93">l</span>et a = <span data-count="93">f</span>st pos in 
  <span data-count="93">l</span>et b = <span data-count="93">s</span>nd pos in
  <span data-count="93">r</span>ed_pao_move_help (List.rev(List.filter (fun h -&gt; <span data-count="930">(</span>snd h) &lt; b) 
                                [(a,1);(a,2);(a,3);(a,4);(a,5);(a,6);(a,7);
                                 (a,8);(a,9);(a,10)])) st

(** [red_pao_move_more_b] is the list of position that red pao can move to with
    the second pos index increased. *)
let red_pao_move_more_b st pos =
  <span data-count="93">l</span>et a = <span data-count="93">f</span>st pos in
  <span data-count="93">l</span>et b = <span data-count="93">s</span>nd pos in
  <span data-count="93">r</span>ed_pao_move_help (List.filter (fun h -&gt; <span data-count="930">(</span>snd h) &gt; b) 
                       [(a,1);(a,2);(a,3);(a,4);(a,5);(a,6);(a,7);(a,8);(a,9);
                        (a,10)]) st

(** [red_pao_move_less_a] is the list of position that red pao can move to with
    the first pos index decreased. *)
let red_pao_move_less_a st pos = 
  <span data-count="93">l</span>et a = <span data-count="93">f</span>st pos in
  <span data-count="93">l</span>et b = <span data-count="93">s</span>nd pos in
  <span data-count="93">r</span>ed_pao_move_help (List.rev (List.filter (fun h -&gt; <span data-count="837">(</span>fst h) &lt; a) 
                                 [(1,b);(2,b);(3,b);(4,b);(5,b);(6,b);(7,b);
                                  (8,b);(9,b)])) st

(** [red_pao_move_more_a] is the list of position that red pao can move to with
    the first pos index increased. *)
let red_pao_move_more_a st pos =
  <span data-count="93">l</span>et a = <span data-count="93">f</span>st pos in
  <span data-count="93">l</span>et b = <span data-count="93">s</span>nd pos in
  <span data-count="93">r</span>ed_pao_move_help (List.filter (fun h -&gt; <span data-count="837">(</span>fst h) &gt; a) 
                       [(1,b);(2,b);(3,b);(4,b);(5,b);(6,b);(7,b);(8,b);
                        (9,b)]) st

(** [black_pao_fly lst accu st] is the list of positions black pao can fly to.*)
let rec black_pao_fly lst accu st=
  <span data-count="371">m</span>atch lst with
  |<span data-count="101">[</span>] -&gt; accu
  |<span data-count="270">h</span>::t -&gt; if (occupied_by_red h st) then <span data-count="60">(</span>h::accu) 
    else <span data-count="210">i</span>f (occupied_by_black h st) then <span data-count="24">a</span>ccu
    else <span data-count="186">b</span>lack_pao_fly t accu st

(** [black_pao_move_furthuer lst accu st] is the list of positions black pao can 
    move further to. *)
let rec black_pao_move_further lst accu st=
  <span data-count="946">m</span>atch lst with
  |<span data-count="86">[</span>] -&gt; accu
  | <span data-count="860">h</span>::t -&gt; if <span data-count="860">(</span>occupied_by_black h st) || <span data-count="741">(</span>occupied_by_red h st)
    then <span data-count="185">(</span>black_pao_fly t [] st) @ accu
    else <span data-count="675">b</span>lack_pao_move_further t (h::accu) st

(** [black_pao_move_help lst st] is the helper function for moving black pao. *)
let black_pao_move_help lst st=
  <span data-count="276">m</span>atch lst with
  |<span data-count="5">[</span>] -&gt; []
  |<span data-count="271">h</span>::t -&gt; black_pao_move_further lst [] st

(** [black_pao_move_less_b] is the list of position that black pao can move to 
    with the second pos index decreased. *)
let black_pao_move_less_b st pos = 
  <span data-count="69">l</span>et a = <span data-count="69">f</span>st pos in 
  <span data-count="69">l</span>et b = <span data-count="69">s</span>nd pos in
  <span data-count="69">b</span>lack_pao_move_help (List.rev(List.filter (fun h -&gt; <span data-count="690">(</span>snd h) &lt; b) 
                                  [(a,1);(a,2);(a,3);(a,4);(a,5);(a,6);(a,7);
                                   (a,8);(a,9);(a,10)])) st

(** [black_pao_move_more_b] is the list of position that black pao can move to 
    with the second pos index increased. *)
let black_pao_move_more_b st pos = 
  <span data-count="69">l</span>et a = <span data-count="69">f</span>st pos in
  <span data-count="69">l</span>et b = <span data-count="69">s</span>nd pos in
  <span data-count="69">b</span>lack_pao_move_help (List.filter (fun h -&gt; <span data-count="690">(</span>snd h) &gt; b) 
                         [(a,1);(a,2);(a,3);(a,4);(a,5);(a,6);(a,7);(a,8);(a,9);
                          (a,10)]) st

(** [black_pao_move_less_a] is the list of position that black pao can move to
    with the first pos index decreased. *)
let black_pao_move_less_a st pos =
  <span data-count="69">l</span>et a = <span data-count="69">f</span>st pos in
  <span data-count="69">l</span>et b = <span data-count="69">s</span>nd pos in
  <span data-count="69">b</span>lack_pao_move_help (List.rev (List.filter (fun h -&gt; <span data-count="621">(</span>fst h) &lt; a) 
                                   [(1,b);(2,b);(3,b);(4,b);(5,b);(6,b);(7,b);
                                    (8,b);(9,b)])) st

(** [black_pao_move_more_a] is the list of position that black pao can move to
    with the first pos index increased. *)
let black_pao_move_more_a st pos =
  <span data-count="69">l</span>et a = <span data-count="69">f</span>st pos in
  <span data-count="69">l</span>et b = <span data-count="69">s</span>nd pos in
  <span data-count="69">b</span>lack_pao_move_help (List.filter (fun h -&gt; <span data-count="621">(</span>fst h) &gt; a) 
                         [(1,b);(2,b);(3,b);(4,b);(5,b);(6,b);(7,b);(8,b);
                          (9,b)]) st 

(** [black_move_further lst accu st] is the list of positions 
    that the black Che can move to among positions in [lst] in state [st],
    given that [lst] is not empty. *)
let rec black_move_further lst accu st=
  <span data-count="1877">m</span>atch lst with
  |<span data-count="176">[</span>] -&gt; accu
  |<span data-count="1701">h</span>::t -&gt; if <span data-count="1701">(</span>occupied_by_black h st) = false &amp;&amp; <span data-count="1448">(</span>occupied_by_red h st) = false  
    then <span data-count="1365">b</span>lack_move_further t (h::accu) st
    else <span data-count="336">i</span>f (occupied_by_red h st) = true 
    then <span data-count="83">h</span>::accu
    else <span data-count="253">a</span>ccu

(** [black_move_help lst st] is the list of positions 
    that the black Che can move to among positions in [lst] in state [st]. *)
let black_move_help lst st= 
  <span data-count="656">m</span>atch lst with
  |<span data-count="144">[</span>] -&gt; []
  |<span data-count="512">h</span>::t -&gt; black_move_further lst [] st

(**[black_move_less_b st pos] is list of valid position that Che can be moved to 
    in the negative b direction from current position [pos] in state [st]. *)
let black_move_less_b st pos= 
  <span data-count="164">l</span>et a = <span data-count="164">f</span>st pos in
  <span data-count="164">l</span>et b = <span data-count="164">s</span>nd pos in
  <span data-count="164">b</span>lack_move_help (List.rev(List.filter (fun h -&gt; <span data-count="1640">(</span>snd h) &lt; b) 
                              [(a,1);(a,2);(a,3);(a,4);(a,5);(a,6);(a,7);(a,8);
                               (a,9);(a,10)])) st

(**[black_move_more_b st pos] is list of valid position that Che can be moved to 
    in the positive b direction from current position [pos] in state [st]. *)
let black_move_more_b st pos =
  <span data-count="164">l</span>et a = <span data-count="164">f</span>st pos in 
  <span data-count="164">l</span>et b = <span data-count="164">s</span>nd pos in 
  <span data-count="164">b</span>lack_move_help (List.filter (fun h -&gt; <span data-count="1640">(</span>snd h) &gt; b) 
                     [(a,1);(a,2);(a,3);(a,4);(a,5);(a,6);(a,7);(a,8);(a,9);
                      (a,10)]) st

(**[black_move_less_a st pos] is list of valid position that Che can be moved to 
    in the negative a direction from current position [pos] in state [st]. *)
let black_move_less_a st pos = 
  <span data-count="164">l</span>et a = <span data-count="164">f</span>st pos in
  <span data-count="164">l</span>et b = <span data-count="164">s</span>nd pos in 
  <span data-count="164">b</span>lack_move_help (List.rev (List.filter (fun h -&gt; <span data-count="1476">(</span>fst h) &lt; a)
                               [(1,b);(2,b);(3,b);(4,b);(5,b);(6,b);(7,b);(8,b);
                                (9,b)])) st

(**[black_move_more_a st pos] is list of valid position that Che can be moved to 
    in the positive a direction from current position [pos] in state [st]. *)
let black_move_more_a st pos =
  <span data-count="164">l</span>et a = <span data-count="164">f</span>st pos in
  <span data-count="164">l</span>et b = <span data-count="164">s</span>nd pos in
  <span data-count="164">b</span>lack_move_help (List.filter (fun h -&gt; <span data-count="1476">(</span>fst h) &gt; a)
                     [(1,b);(2,b);(3,b);(4,b);(5,b);(6,b);(7,b);(8,b);(9,b)]) st

(** [red_move_further lst accu st] is the list of positions that the red Che can 
    move to among positions in [lst] in state [st], given that [lst] is not 
    empty. *)
let rec red_move_further lst accu st = 
  <span data-count="1363">m</span>atch lst with
  |<span data-count="127">[</span>] -&gt; accu
  |<span data-count="1236">h</span>::t -&gt; if <span data-count="1236">(</span>occupied_by_red h st) = false &amp;&amp; <span data-count="1038">(</span>occupied_by_black h st) = false 
    then <span data-count="994">r</span>ed_move_further t (h::accu) st
    else <span data-count="242">i</span>f (occupied_by_black h st) = true
    then <span data-count="44">h</span>::accu
    else <span data-count="198">a</span>ccu

(** [red_move_help lst st] is the list of positions that the red Che can move to 
    among positions in [lst] in state [st]. *)
let red_move_help lst st =
  <span data-count="476">m</span>atch lst with
  |<span data-count="107">[</span>] -&gt; []
  |<span data-count="369">h</span>::t -&gt; red_move_further lst [] st

(**[red_move_less_b st pos] is list of valid position that Che can be moved to 
    in the negative b direction from current position [pos] in state [st]. *)
let red_move_less_b st pos =
  <span data-count="119">l</span>et a = <span data-count="119">f</span>st pos in
  <span data-count="119">l</span>et b = <span data-count="119">s</span>nd pos in
  <span data-count="119">r</span>ed_move_help (List.rev (List.filter (fun h -&gt; <span data-count="1190">(</span>snd h) &lt; b)
                             [(a,1);(a,2);(a,3);(a,4);(a,5);(a,6);(a,7);(a,8);
                              (a,9);(a,10)])) st

(**[red_move_more_b st pos] is list of valid position that Che can be moved to 
    in the positive b direction from current position [pos] in state [st]. *)
let red_move_more_b st pos = 
  <span data-count="119">l</span>et a = <span data-count="119">f</span>st pos in 
  <span data-count="119">l</span>et b = <span data-count="119">s</span>nd pos in 
  <span data-count="119">r</span>ed_move_help (List.filter (fun h -&gt; <span data-count="1190">(</span>snd h) &gt; b)
                   [(a,1);(a,2);(a,3);(a,4);(a,5);(a,6);(a,7);(a,8);(a,9);
                    (a,10)]) st

(**[red_move_less_a st pos] is list of valid position that Che can be moved to 
    in the negative a direction from current position [pos] in state [st]. *)
let red_move_less_a st pos =
  <span data-count="119">l</span>et a = <span data-count="119">f</span>st pos in 
  <span data-count="119">l</span>et b = <span data-count="119">s</span>nd pos in 
  <span data-count="119">r</span>ed_move_help (List.rev (List.filter (fun h -&gt; <span data-count="1071">(</span>fst h) &lt; a)
                             [(1,b);(2,b);(3,b);(4,b);(5,b);(6,b);(7,b);(8,b);
                              (9,b)])) st

(**[red_move_more_a st pos] is list of valid position that Che can be moved to 
    in the positive a direction from current position [pos] in state [st]. *)
let red_move_more_a st pos = 
  <span data-count="119">l</span>et a = <span data-count="119">f</span>st pos in 
  <span data-count="119">l</span>et b = <span data-count="119">s</span>nd pos in 
  <span data-count="119">r</span>ed_move_help (List.filter (fun h -&gt; <span data-count="1071">(</span>fst h) &gt; a)
                   [(1,b);(2,b);(3,b);(4,b);(5,b);(6,b);(7,b);(8,b);(9,b)]) st


(** [next_valid_bing current_pos st] is a list of next valid position of chess 
    Bing. If there are Red color chess in the potential valid position, that 
    position becomes invalid. However, if there are Black color chess in the 
    potential valid position, that position is still valid. Bing can only move 
    forward when it has not crossed the river. It can move forward, left, or 
    right after it cross the river. It can never move backward.
    Require: current_pos is a valid position.  *)
let next_valid_bing current_pos st= 
  <span data-count="101">l</span>et a = <span data-count="101">f</span>st current_pos in 
  <span data-count="101">l</span>et b = <span data-count="101">s</span>nd current_pos in
  <span data-count="101">l</span>et red_pos = <span data-count="101">s</span>t.red_remain_chess |&gt; <span data-count="101">p</span>os_lst in 
  <span data-count="101">l</span>et potential = 
    <span data-count="101">i</span>f <span data-count="101">b</span> &gt;= 6 &amp;&amp; <span data-count="60">b</span> &lt;= 7 then <span data-count="60">[</span>(a, b-1)]
    else <span data-count="41">i</span>f <span data-count="41">b</span>&lt;= 5 &amp;&amp; <span data-count="41">b</span> &gt; 1 then <span data-count="37">b</span>egin 
      if <span data-count="37">a</span> &gt;= 2 &amp;&amp; <span data-count="31">a</span> &lt;= 8 then <span data-count="25">[</span>(a-1, b); (a+1,b); (a, b-1)]
      else <span data-count="12">i</span>f a = 1 then <span data-count="6">[</span>(a+1, b); (a, b-1)]
      else <span data-count="6">i</span>f a = 9 then <span data-count="6">[</span>(a-1, b); (a, b-1)] 
      else <span data-count="0">f</span>ailwith "impossible" end 
    else <span data-count="4">i</span>f b = 1 then <span data-count="4">b</span>egin 
      if <span data-count="4">a</span> &gt;= 2 &amp;&amp; <span data-count="3">a</span> &lt;= 8 then <span data-count="2">[</span>(a-1, b); (a+1,b)]
      else <span data-count="2">i</span>f a = 1 then <span data-count="1">[</span>(a+1, b)]
      else <span data-count="1">i</span>f a = 9 then <span data-count="1">[</span>(a-1, b)]
      else <span data-count="0">f</span>ailwith "impossible" end
    else <span data-count="0">f</span>ailwith "impossible"
  in <span data-count="101">L</span>ist.filter (fun elt -&gt; <span data-count="165">n</span>ot (List.mem elt red_pos)) potential

(** [next_valid_zu current_pos st] is a list of next valid position of chess 
    Zu. If there are Black color chess in the potential valid position, that 
    position becomes invalid. However, if there are Red color chess in the 
    potential valid position, that position is still valid. Zu can only move 
    forward when it has not crossed the river. It can move forward, left, or 
    right after it cross the river. It can never move backward.
    Require: current_pos is a valid position.  *)
let next_valid_zu current_pos st= 
  <span data-count="107">l</span>et a = <span data-count="107">f</span>st current_pos in
  <span data-count="107">l</span>et b = <span data-count="107">s</span>nd current_pos in
  <span data-count="107">l</span>et black = <span data-count="107">s</span>t.black_remain_chess in 
  <span data-count="107">l</span>et black_pos = <span data-count="107">p</span>os_lst black in 
  <span data-count="107">l</span>et potential =
    <span data-count="107">i</span>f <span data-count="107">b</span>&lt;= 5 &amp;&amp; <span data-count="67">b</span> &gt;= 4 then <span data-count="67">[</span>(a, b+1)]
    else <span data-count="40">i</span>f <span data-count="40">b</span>&gt;= 6 &amp;&amp; <span data-count="40">b</span> &lt; 10 then <span data-count="34">b</span>egin 
      if <span data-count="34">a</span> &gt;= 2 &amp;&amp; <span data-count="29">a</span> &lt;= 8 then <span data-count="24">[</span>(a-1, b);(a+1,b);(a,b+1)]
      else <span data-count="10">i</span>f a = 1 then <span data-count="5">[</span>(a+1, b);(a, b+1)]
      else <span data-count="5">i</span>f a =9 then <span data-count="5">[</span>(a-1, b);(a, b+1)]
      else <span data-count="0">f</span>ailwith "impossible" end 
    else <span data-count="6">i</span>f b = 10 then <span data-count="6">b</span>egin 
      if <span data-count="6">a</span> &gt;= 2 &amp;&amp; <span data-count="4">a</span> &lt;= 8 then <span data-count="2">[</span>(a-1, b);(a+1,b)]
      else <span data-count="4">i</span>f a =1 then <span data-count="2">[</span>(a+1, b)]
      else <span data-count="2">i</span>f a = 9 then <span data-count="2">[</span>(a-1, b)]
      else <span data-count="0">f</span>ailwith "impossible" end 
    else <span data-count="0">f</span>ailwith "impossible"
  in <span data-count="107">L</span>ist.filter (fun elt -&gt; <span data-count="167">n</span>ot (List.mem elt black_pos)) potential

(** [redxiang_pos a b x y f st lst current_pos accu]
    is whether the lower right position should be add to valid next positions list
    based on current x [a]; current y [b]; next x [x]; next y [y]; function for 
    recursion [f]; current state [st]; current position [current_pos]; 
    list of already valified next positions [accu]. *)
let redxiang_pos a b x y f st lst current_pos accu=
  <span data-count="38">i</span>f <span data-count="38">o</span>ccupied_by_red (a, b) st || <span data-count="36">o</span>ccupied_by_black (a, b) st
  then <span data-count="4">f</span> current_pos lst accu st
  else <span data-count="34">i</span>f occupied_by_red (x, y) st 
  then <span data-count="2">f</span> current_pos lst accu st
  else <span data-count="32">f</span> current_pos lst ((x,y)::accu) st

(** [next_valid_xiang_red current_pos st] is a list of next valid position of 
    chess Xiang. If there are Red color chess in the potential valid position, 
    that position becomes invalid. However, if there are Black color chess in 
    the potential valid position, that position is still valid. Let a denotes 
    the x value of Xiang's current position, and let b denotes the y value of 
    Xiang's current position. Xiang can only move to four positions: (a-2,b+2)
    if it is on the board and (a-1,b+1) is not occupied by either a Red chess 
    or a black chess;(a-2,b-2) if it is on the board and (a-1,b-1) is not 
    occupied by either a Red chess or a black chess;(a+2,b+2)if it is on the 
    board and (a+1,b+1) is not occupied by either a Red chess or a black chess;
    (a+2,b-2)if it is on the board and (a+1,b-1) is not occupied by either 
    a Red chess or a black chess; Xiang cannot across the rive. 
    Require: current_pos is a valid position.  *)
let rec next_xiang_red_help current_pos lst accu st=
  <span data-count="65">m</span>atch lst with
  | <span data-count="13">[</span>] -&gt; accu
  | <span data-count="52">(</span>x,y)::t -&gt; 
    let a = <span data-count="52">f</span>st current_pos in <span data-count="52">l</span>et b = <span data-count="52">s</span>nd current_pos in
    <span data-count="52">i</span>f <span data-count="52">x</span> &gt;= 1 &amp;&amp; <span data-count="100">x</span> &lt;= 9 &amp;&amp; <span data-count="92">y</span> &gt;= 1 &amp;&amp; <span data-count="46">y</span> &lt;= 10 then
      <span data-count="38">b</span>egin 
        if <span data-count="38">x</span>-a = -2 &amp;&amp; <span data-count="20">y</span>-b = 2 then
          <span data-count="8">r</span>edxiang_pos (a-1) (b+1) x y (next_xiang_red_help) 
            st t current_pos accu  
        else <span data-count="30">i</span>f <span data-count="30">x</span>-a = -2 &amp;&amp; <span data-count="12">y</span>-b = -2 then
          <span data-count="12">r</span>edxiang_pos (a-1) (b-1) x y (next_xiang_red_help) 
            st t current_pos accu
        else <span data-count="18">i</span>f <span data-count="18">x</span>-a = 2 &amp;&amp; <span data-count="18">y</span>-b = 2 then
          <span data-count="7">r</span>edxiang_pos (a+1) (b+1) x y (next_xiang_red_help) 
            st t current_pos accu
        else 
          <span data-count="11">r</span>edxiang_pos (a+1) (b-1) x y (next_xiang_red_help) 
            st t current_pos accu
      end 
    else <span data-count="14">n</span>ext_xiang_red_help current_pos t accu st

(** [next_valid_xiang_red current_pos st] returns a list of postions Xiang-1 or 
    Xiang-2 can move to based on its current position [current_pos] in current 
    state [st]. *)
let next_valid_xiang_red current_pos st= 
  <span data-count="13">l</span>et a = <span data-count="13">f</span>st current_pos in
  <span data-count="13">l</span>et b = <span data-count="13">s</span>nd current_pos in
  <span data-count="13">n</span>ext_xiang_red_help current_pos 
    [(a-2, b+2);(a-2, b-2);(a+2, b+2);(a+2, b-2)]
    [] st

(**[blackxiang_pos a b x y f st lst current_pos accu]
   is whether the upper right position should be add to valid next positions 
   list based on current x [a]; current y [b]; next x [x]; next y [y]; function 
   for recursion [f]; current state [st]; current position [current_pos]; 
   list of already valified next positions [accu]. *)
let blackxiang_pos a b x y f st lst current_pos accu=
  <span data-count="36">i</span>f <span data-count="36">o</span>ccupied_by_red (a,b) st ||<span data-count="34">o</span>ccupied_by_black (a,b) st
  then <span data-count="3">f</span> current_pos lst accu st
  else <span data-count="33">i</span>f occupied_by_black (x, y) st 
  then <span data-count="3">f</span> current_pos lst accu st
  else <span data-count="30">f</span> current_pos lst ((x,y)::accu) st

(** [next_xiang_black_help current_pos lst accu st] is the list of valid 
    next positions [accu] determined based on Black Xiang's current position 
    [current_pos] and the list of possibly valid locations [lst] in current 
    state [st]*)
let rec next_xiang_black_help current_pos lst accu st =
  <span data-count="60">m</span>atch lst with
  |<span data-count="12">[</span>] -&gt; accu
  |<span data-count="48">(</span>x,y)::t -&gt; 
    let a = <span data-count="48">f</span>st current_pos in <span data-count="48">l</span>et b = <span data-count="48">s</span>nd current_pos in
    <span data-count="48">i</span>f <span data-count="48">x</span> &gt;=1 &amp;&amp; <span data-count="92">x</span> &lt;= 9 &amp;&amp; <span data-count="88">y</span>&gt;= 1 &amp;&amp; <span data-count="36">y</span> &lt;= 10 then
      <span data-count="36">b</span>egin 
        if <span data-count="36">x</span>-a = -2 &amp;&amp; <span data-count="18">y</span>-b = 2 then 
          <span data-count="11">b</span>lackxiang_pos (a-1) (b+1) x y (next_xiang_black_help) 
            st t current_pos accu
        else <span data-count="25">i</span>f <span data-count="25">x</span>-a = -2 &amp;&amp; <span data-count="7">y</span>-b = -2 then
          <span data-count="7">b</span>lackxiang_pos (a-1) (b-1) x y (next_xiang_black_help) 
            st t current_pos accu
        else <span data-count="18">i</span>f <span data-count="18">x</span>-a = 2 &amp;&amp; <span data-count="18">y</span>-b = 2 then
          <span data-count="11">b</span>lackxiang_pos (a+1) (b+1) x y (next_xiang_black_help) 
            st t current_pos accu
        else
          <span data-count="7">b</span>lackxiang_pos (a+1) (b-1) x y (next_xiang_black_help) 
            st t current_pos accu
      end
    else <span data-count="12">n</span>ext_xiang_black_help current_pos t accu st

(** [next_valid_xiang_black current_pos st] is a list of next valid position of 
    chess Xiang. If there are Black color chess in the potential valid position, 
    that position becomes invalid. However, if there are Red color chess in 
    the potential valid position, that position is still valid. Let a denotes 
    the x value of Xiang's current position, and let b denotes the y value of 
    Xiang's current position. Xiang can only move to four positions: (a-2,b+2)
    if it is on the board and (a-1,b+1) is not occupied by either a Red chess 
    or a black chess;(a-2,b-2) if it is on the board and (a-1,b-1) is not 
    occupied by either a Red chess or a black chess;(a+2,b+2)if it is on the 
    board and (a+1,b+1) is not occupied by either a Red chess or a black chess;
    (a+2,b-2)if it is on the board and (a+1,b-1) is not occupied by either 
    a Red chess or a black chess; Xiang cannot across the rive. 
    Require: current_pos is a valid position.  *)
let next_valid_xiang_black current_pos st = 
  <span data-count="12">l</span>et a = <span data-count="12">f</span>st current_pos in
  <span data-count="12">l</span>et b = <span data-count="12">s</span>nd current_pos in
  <span data-count="12">n</span>ext_xiang_black_help current_pos 
    [(a-2, b+2);(a-2, b-2);(a+2, b+2);(a+2, b-2)]
    [] st

(** [redma_pos a b x y f st lst current_pos accu] is the position of red ma. *)
let redma_pos a b x y f st lst current_pos accu=
  <span data-count="243">i</span>f <span data-count="243">o</span>ccupied_by_red (a, b) st || <span data-count="154">o</span>ccupied_by_black (a, b) st
  then <span data-count="89">f</span> current_pos lst accu st
  else <span data-count="154">i</span>f occupied_by_red (x, y) st 
  then <span data-count="24">f</span> current_pos lst accu st
  else <span data-count="130">f</span> current_pos lst ((x,y)::accu) st

(**[ma_red_help current_pos lst accu st] is the list of positions 
   the red Ma can move to among positions in the list [lst] 
   from current position [current_pos] in state [st]. *)
let rec ma_red_help current_pos lst accu st=
  <span data-count="369">m</span>atch lst with
  | <span data-count="41">[</span>] -&gt; accu
  | <span data-count="328">(</span>x,y)::t -&gt; 
    let a = <span data-count="328">f</span>st current_pos in
    <span data-count="328">l</span>et b = <span data-count="328">s</span>nd current_pos in
    <span data-count="328">i</span>f <span data-count="328">x</span> &gt;= 1 &amp;&amp; <span data-count="656">x</span> &lt;= 9 &amp;&amp; <span data-count="588">y</span> &gt;= 1 &amp;&amp; <span data-count="294">y</span> &lt;= 10 then
      <span data-count="243">b</span>egin 
        if x-a = -2 then
          <span data-count="65">r</span>edma_pos (a-1) b x y (ma_red_help) st t current_pos accu  
        else <span data-count="178">i</span>f x-a = 2 then
          <span data-count="48">r</span>edma_pos (a+1) b x y (ma_red_help) st t current_pos accu
        else <span data-count="130">i</span>f y-b = 2 then
          <span data-count="48">r</span>edma_pos a (b+1) x y (ma_red_help) st t current_pos accu
        else 
          <span data-count="82">r</span>edma_pos a (b-1) x y (ma_red_help) st t current_pos accu
      end 
    else <span data-count="85">m</span>a_red_help current_pos t accu st

(** [ma_red current_pos st] is positions the red Ma can move to from
    current position [current_pos] in state [st]. *)
let next_valid_ma_red current_pos st = 
  <span data-count="41">l</span>et a = <span data-count="41">f</span>st current_pos in
  <span data-count="41">l</span>et b = <span data-count="41">s</span>nd current_pos in
  <span data-count="41">m</span>a_red_help current_pos 
    [(a-2, b+1);(a-2, b-1);(a+2, b+1);(a+2, b-1);(a-1,b+2);(a+1,b+2);(a-1,b-2);
     (a+1,b-2)]
    [] st

(**[ma_black_help current_pos lst accu st] is the list of positions 
   the black Ma can move to among positions in the list [lst] from current 
   position [current_pos] in state [st]. *)
let rec ma_black_help current_pos lst accu st =
  <span data-count="360">l</span>et helper t x y a b = 
    <span data-count="240">i</span>f <span data-count="240">o</span>ccupied_by_red (a,b) st ||<span data-count="240">o</span>ccupied_by_black (a,b) st
    then <span data-count="80">m</span>a_black_help current_pos t accu st
    else <span data-count="160">i</span>f occupied_by_black (x, y) st 
    then <span data-count="32">m</span>a_black_help current_pos t accu st
    else <span data-count="128">m</span>a_black_help current_pos t ((x,y)::accu) st
  in 
  <span data-count="360">m</span>atch lst with
  |<span data-count="40">[</span>] -&gt; accu
  |<span data-count="320">(</span>x,y)::t -&gt; 
    let a = <span data-count="320">f</span>st current_pos in
    <span data-count="320">l</span>et b = <span data-count="320">s</span>nd current_pos in
    <span data-count="320">i</span>f <span data-count="320">x</span> &gt;=1 &amp;&amp; <span data-count="576">x</span> &lt;= 9 &amp;&amp; <span data-count="576">y</span>&gt;= 1 &amp;&amp; <span data-count="240">y</span> &lt;= 10 then
      <span data-count="240">b</span>egin 
        if x-a = -2 then <span data-count="48">h</span>elper t x y (a-1) b
        else <span data-count="192">i</span>f x-a = 2 then <span data-count="64">h</span>elper t x y (a+1) b
        else <span data-count="128">i</span>f y-b = 2 then <span data-count="80">h</span>elper t x y a (b+1)
        else <span data-count="48">h</span>elper t x y a (b-1)
      end 
    else <span data-count="80">m</span>a_black_help current_pos t accu st

(** [next_valid_ma_black current_pos st] is positions the black Ma can move to 
    from current position [current_pos] in state [st]. *)
let next_valid_ma_black current_pos st = 
  <span data-count="40">l</span>et a = <span data-count="40">f</span>st current_pos in 
  <span data-count="40">l</span>et b = <span data-count="40">s</span>nd current_pos in
  <span data-count="40">m</span>a_black_help current_pos 
    [(a-2, b+1);(a-2, b-1);(a+2, b+1);(a+2, b-1);(a-1,b+2);(a+1,b+2);(a-1,b-2);
     (a+1,b-2)]
    [] st

(** [next_valid_che_red current_pos st] is positions the red Che can move to 
    from current position [current_pos] in state [st]. *)
let next_valid_che_red current_pos st = 
  <span data-count="119">(</span>red_move_less_b st current_pos) @ (red_move_more_b st current_pos) 
  @ (red_move_less_a st current_pos) @ (red_move_more_a st current_pos)

(** [next_valid_che_black current_pos st] is positions the black Che can move to 
    from current position [current_pos] in state [st]. *)
(* Functions that will be written during MS2 *)
let next_valid_che_black current_pos st = 
  <span data-count="164">(</span>black_move_less_b st current_pos) @ (black_move_more_b st current_pos)
  @ (black_move_less_a st current_pos) @ (black_move_more_a st current_pos)

(* Functions that will be written during MS2 *)
let next_valid_pao_red current_pos st = 
  <span data-count="93">(</span>red_pao_move_less_b st current_pos) @ (red_pao_move_more_b st current_pos)
  @ (red_pao_move_less_a st current_pos) @ (red_pao_move_more_a st current_pos)

(* Functions that will be written during MS2 *)
let next_valid_pao_black current_pos st = 
  <span data-count="69">(</span>black_pao_move_less_b st current_pos) 
  @ (black_pao_move_more_b st current_pos)
  @ (black_pao_move_less_a st current_pos) 
  @ (black_pao_move_more_a st current_pos)

(** [next_valid_shi current_pos st] is a list of next valid position of black 
    shi. If there are Black color chess in the potential valid position, that 
    position becomes invalid. However, if there are Red color chess in the 
    potential valid position, that position is still valid. 
    Require: current_pos is a valid position, i.e. [pos] is inside Tianzige.  *)
let next_valid_shi_black current_pos st= 
  <span data-count="27">l</span>et black = <span data-count="27">s</span>t.black_remain_chess in 
  <span data-count="27">l</span>et black_pos = <span data-count="27">p</span>os_lst black in 
  <span data-count="27">l</span>et potential =
    <span data-count="27">m</span>atch current_pos with
    |<span data-count="11">(</span>4,1) -&gt; [(5,2)]
    |<span data-count="1">(</span>6,1) -&gt; [(5,2)]
    |<span data-count="13">(</span>5,2) -&gt; [(4,1); (6,1); (4,3);(6,3)]
    |<span data-count="1">(</span>4,3) -&gt; [(5,2)]
    |<span data-count="1">(</span>6,3) -&gt; [(5,2)]
    |<span data-count="0">_</span> -&gt; failwith "impossible"
  in <span data-count="27">L</span>ist.filter (fun elt -&gt; <span data-count="66">n</span>ot (List.mem elt black_pos)) potential

(** [next_valid_shi current_pos st] is a list of next valid position of red shi. 
    If there are Red color chess in the potential valid position, that position 
    becomes invalid. However, if there are Black color chess in the potential 
    valid position, that position is still valid. 
    Require: current_pos is a valid position, i.e. [pos] is inside Tianzige.  *)
let next_valid_shi_red current_pos st= 
  <span data-count="28">l</span>et red = <span data-count="28">s</span>t.red_remain_chess in 
  <span data-count="28">l</span>et red_pos = <span data-count="28">p</span>os_lst red in
  <span data-count="28">l</span>et potential =
    <span data-count="28">m</span>atch current_pos with
    |<span data-count="9">(</span>6,10) -&gt; [(5,9)]
    |<span data-count="7">(</span>4,10) -&gt; [(5,9)]
    |<span data-count="10">(</span>5,9) -&gt; [(6,10); (4,10); (6,8); (4,8)]
    |<span data-count="2">(</span>6,8) -&gt; [(5,9)]
    |<span data-count="0">(</span>4,8) -&gt; [(5,9)]
    |<span data-count="0">_</span> -&gt; failwith "impossible"
  in <span data-count="28">L</span>ist.filter (fun elt -&gt; <span data-count="58">n</span>ot (List.mem elt red_pos)) potential

(** [next_valid_jiang current_pos st] is a list of next valid position of Jiang. 
    If there are Black color chess in the potential valid position, that 
    position becomes invalid. However, if there are Red color chess in the 
    potential valid position, that position is still valid. 
    Require: current_pos is a valid position, i.e. [pos] is inside Tianzige.  *)
let next_valid_jiang current_pos st = 
  <span data-count="21">l</span>et black = <span data-count="21">s</span>t.black_remain_chess in 
  <span data-count="21">l</span>et black_pos = <span data-count="21">p</span>os_lst black in 
  <span data-count="21">l</span>et potential = 
    <span data-count="21">m</span>atch current_pos with 
    | <span data-count="5">(</span>5, 1) -&gt; [(6, 1); (4, 1); (5, 2)]
    | <span data-count="3">(</span>4, 1) -&gt; [(5, 1); (4, 2)]
    | <span data-count="2">(</span>6, 1) -&gt; [(5, 1); (6, 2)]
    | <span data-count="4">(</span>5, 2) -&gt; [(5, 1); (5, 3); (4, 2); (6, 2)]
    | <span data-count="1">(</span>4, 2) -&gt; [(4, 1); (4, 3); (5, 2)]
    | <span data-count="1">(</span>6, 2) -&gt; [(6, 1); (6, 3); (5, 2)]
    | <span data-count="3">(</span>5, 3) -&gt; [(5, 2); (4, 3); (6, 3)]
    | <span data-count="1">(</span>4, 3) -&gt; [(5, 3); (4, 2)]
    | <span data-count="1">(</span>6, 3) -&gt; [(5, 3); (6, 2)]
    | <span data-count="0">_</span> -&gt; failwith "Next Valid Jiang Impossible"
  in <span data-count="21">L</span>ist.filter (fun elt -&gt; <span data-count="60">n</span>ot (List.mem elt black_pos)) potential 

(** [next_valid_shuai current_pos st] is a list of next valid position of Shuai. 
    If there are Red color chess in the potential valid position, that position 
    becomes invalid. However, if there are Red color chess in the potential 
    valid position, that position is still valid. 
    Require: current_pos is a valid position. [pos] is inside Tianzige.  *)
let next_valid_shuai current_pos st = 
  <span data-count="16">l</span>et red = <span data-count="16">s</span>t.red_remain_chess in 
  <span data-count="16">l</span>et red_pos = <span data-count="16">p</span>os_lst red in 
  <span data-count="16">l</span>et potential = 
    <span data-count="16">m</span>atch current_pos with 
    | <span data-count="4">(</span>5, 10) -&gt; [(6, 10); (4, 10); (5, 9)]
    | <span data-count="1">(</span>4, 10) -&gt; [(5, 10); (4, 9)]
    | <span data-count="1">(</span>6, 10) -&gt; [(5, 10); (6, 9)]
    | <span data-count="3">(</span>5, 9) -&gt; [(5, 10); (5, 8); (4, 9); (6, 9)]
    | <span data-count="1">(</span>4, 9) -&gt; [(4, 10); (4, 8); (5, 9)]
    | <span data-count="1">(</span>6, 9) -&gt; [(6, 10); (6, 8); (5, 9)]
    | <span data-count="2">(</span>5, 8) -&gt; [(5, 9); (4, 8); (6, 8)]
    | <span data-count="2">(</span>4, 8) -&gt; [(5, 8); (4, 9)]
    | <span data-count="1">(</span>6, 8) -&gt; [(5, 8); (6, 9)]
    | <span data-count="0">_</span> -&gt; failwith "Next Valid Shuai Impossible"
  in <span data-count="16">L</span>ist.filter (fun elt -&gt; <span data-count="46">n</span>ot (List.mem elt red_pos)) potential

(** [current_pos color name st] is the current position of the chess with [name] 
    and has color [color]. *)
let current_pos color name st = 
  <span data-count="851">l</span>et rec current_pos_helper name lst = 
    <span data-count="7597">m</span>atch lst with 
    | <span data-count="0">[</span>] -&gt; failwith "Impossible current position"
    | <span data-count="7597">h</span>::t -&gt; if fst h = name then <span data-count="851">s</span>nd h else <span data-count="6746">c</span>urrent_pos_helper name t 
  in
  <span data-count="851">i</span>f color = Board.Red 
  then <span data-count="411">l</span>et lst = <span data-count="411">s</span>t.red_remain_chess in <span data-count="411">c</span>urrent_pos_helper name lst 
  else <span data-count="440">l</span>et lst = <span data-count="440">s</span>t.black_remain_chess in <span data-count="440">c</span>urrent_pos_helper name lst


(** [check_color name color b] is true if the chess [name] has the same color
    as [color]. False otherwise. 
    Raise [UnknownChess name] if it is not a valid chess name. *)
let check_color name color b= 
  <span data-count="0">l</span>et chess_color = <span data-count="0">B</span>oard.color b name in 
  <span data-count="0">c</span>hess_color = color

(** [modify_remain_chess chess nextpos lst acc] modify the current remain 
    chess if [chess] is not inside current_remain_chess.  *)
let rec modify_remain_chess chess nextpos lst acc = 
  <span data-count="13090">m</span>atch lst with 
  | <span data-count="770">[</span>] -&gt; acc
  | <span data-count="12320">h</span>::t -&gt; if fst h =chess 
    then <span data-count="770">m</span>odify_remain_chess chess nextpos t ((chess, nextpos)::acc)
    else  <span data-count="11550">m</span>odify_remain_chess chess nextpos t (h::acc)

(** [delete_chess chess nextpos lst acc] delete current remain chess if [chess]
    is inside the current_remain_chess. *)
let rec delete_chess chess nextpos lst acc = 
  <span data-count="12825">m</span>atch lst with 
  | <span data-count="770">[</span>] -&gt; acc
  | <span data-count="12055">h</span>::t -&gt; if snd h=nextpos 
    then <span data-count="48">d</span>elete_chess chess nextpos t acc
    else <span data-count="12007">d</span>elete_chess chess nextpos t (h::acc)

(** [update_state color chess nextpos st] is [st']. If there is a chess [ch2] 
    with different color on [pos], [ch2] is deleted from the color1_remain_chess 
    list. Then, we update the color2_remain_chess. Specifically, the pos of 
    [chess] is changed into a new position on the board. 
    Require: [pos] is a valid position for [chess]. *)
let update_state color chess nextpos st = 
  <span data-count="770">l</span>et red = <span data-count="770">s</span>t.red_remain_chess in 
  <span data-count="770">l</span>et black = <span data-count="770">s</span>t.black_remain_chess in
  <span data-count="770">i</span>f color = Board.Red 
  then <span data-count="372">l</span>et red_remain_new = <span data-count="372">m</span>odify_remain_chess chess nextpos red [] in 
    <span data-count="372">l</span>et black_remain_new = <span data-count="372">d</span>elete_chess chess nextpos black [] in 
    <span data-count="372">{</span>red_remain_chess = red_remain_new ; black_remain_chess = black_remain_new}
  else <span data-count="398">l</span>et black_remain_new = <span data-count="398">m</span>odify_remain_chess chess nextpos black [] in 
    <span data-count="398">l</span>et red_remain_new = <span data-count="398">d</span>elete_chess chess nextpos red [] in 
    <span data-count="398">{</span>red_remain_chess = red_remain_new ; black_remain_chess = black_remain_new }

let current_red_captured st = 
  <span data-count="851">l</span>et all_red = <span data-count="851">[</span>("Bing", 1); ("Bing", 2); ("Bing", 3); ("Bing", 4); 
                 ("Bing", 5); ("Shi", 1); ("Shi", 2); ("Xiang", 1); 
                 ("Xiang", 2); ("Ma", 1); ("Ma", 2); ("Pao", 1); ("Pao", 2); 
                 ("Che", 1); ("Che", 2); ("Shuai", 1)] in
  <span data-count="851">l</span>et red = <span data-count="851">L</span>ist.map (fun ((name, id), (_, _))
                       -&gt; <span data-count="13465">(</span>name, id)) st.red_remain_chess in 
  <span data-count="851">L</span>ist.filter (fun (name, id) -&gt; <span data-count="13616">n</span>ot (List.mem (name, id) red)) all_red

let current_black_captured st = 
  <span data-count="851">l</span>et all_black = <span data-count="851">[</span>("Zu", 1); ("Zu", 2); ("Zu", 3); ("Zu", 4); 
                   ("Zu", 5); ("Shi", 3); ("Shi", 4); ("Xiang", 3); 
                   ("Xiang", 4); ("Ma", 3); ("Ma", 4); ("Pao", 3); ("Pao", 4); 
                   ("Che", 3); ("Che", 4); ("Jiang", 1)] in
  <span data-count="851">l</span>et black = <span data-count="851">L</span>ist.map (fun ((name, id), (_, _)) 
                         -&gt; <span data-count="13484">(</span>name, id)) st.black_remain_chess in 
  <span data-count="851">L</span>ist.filter (fun (name, id) -&gt; <span data-count="13616">n</span>ot (List.mem (name, id) black)) all_black

(** [check_color_name c name st] raises [InvalidChess error_msg] if [name] is a 
    different color chess compare with [c]; if [name] is an already captured 
    chess; if [name] is an already captured chess and has different color than 
    [c].  *)
let check_color_name c name st = 
  <span data-count="851">l</span>et remain_red = <span data-count="851">L</span>ist.map (fun ((name, id), (pos1, pos2)) 
                              -&gt; <span data-count="13465">(</span>name, id)) st.red_remain_chess in 
  <span data-count="851">l</span>et remain_black = <span data-count="851">L</span>ist.map (fun ((name, id), (pos1, pos2)) 
                                -&gt; <span data-count="13484">(</span>name, id)) st.black_remain_chess in
  <span data-count="851">l</span>et captured_red = <span data-count="851">c</span>urrent_red_captured st in 
  <span data-count="851">l</span>et captured_black = <span data-count="851">c</span>urrent_black_captured st in 
  <span data-count="851">i</span>f c = Board.Red 
  then <span data-count="411">b</span>egin 
    if List.mem name remain_black then <span data-count="0">r</span>aise (InvalidChess "You are attempting to move a black chess. Please select a red chess. ")
    else <span data-count="411">i</span>f List.mem name captured_red then <span data-count="0">r</span>aise (InvalidChess "You are attempting to move a red chess that has already been captured. Please select a red remain chess. ")
    else <span data-count="411">i</span>f List.mem name captured_black then <span data-count="0">r</span>aise (InvalidChess "You are attempting to move a black chess that has already been captured. Please select a red chess. ")
    else <span data-count="411">(</span>)
  end 
  else <span data-count="440">b</span>egin 
    if List.mem name remain_red then <span data-count="0">r</span>aise (InvalidChess "You are attempting to move a red chess. Please select a black chess. ")
    else <span data-count="440">i</span>f List.mem name captured_black then <span data-count="0">r</span>aise (InvalidChess "You are attempting to move a black chess that has already been captured. Please select a black remain chess. ")
    else <span data-count="440">i</span>f List.mem name captured_red then <span data-count="0">r</span>aise (InvalidChess "You are attempting to move a red chess that has already been captured. Please select a black chess. ")
    else <span data-count="440">(</span>)
  end

(** [move_new_state nextpos name color st f] is [r] if attempting to move a 
    chess [name] with color [color] to [nextpos] given that name is valid. 
    [f] is a function that gives the valid position of the related chess. If 
    the [nextpos] is a valid position, it is [Legal st']. If the [nextpos] is 
    not a valid position, it is [Illegal].
    This is a helper function for [move_red nextpos name st] and 
    [move_black next_pos name st]. *)
let move_new_state nextpos name color st f = 
  <span data-count="851">l</span>et cpos = <span data-count="851">c</span>urrent_pos color name st in 
  <span data-count="851">l</span>et valid_pos = <span data-count="851">f</span> cpos st in
  <span data-count="851">i</span>f List.mem nextpos valid_pos 
  then <span data-count="770">L</span>egal (update_state color name nextpos st) 
  else <span data-count="81">I</span>llegal 

(** [move_red nextpos name st] is [r] if attempting to move a chess [name] 
    with color Red to [nextpos]. If the [name] is not a valid chess name, it is 
    [Illegal]. If the [nextpos] is not a valid next position, it is [Illegal].
    Otherwise, it is [Legal st']. 
    This is a helper function for [move nextpos name color b st] *)
let move_red nextpos name st = 
  <span data-count="411">i</span>f <span data-count="411">(</span>fst name = "Bing") &amp;&amp; <span data-count="101">(</span><span data-count="101">s</span>nd name = 1 || <span data-count="182">s</span>nd name = 2 || <span data-count="150">s</span>nd name = 3 || 
                             <span data-count="80">s</span>nd name = 4 || <span data-count="18">s</span>nd name =5)  
  then <span data-count="101">m</span>ove_new_state nextpos name Board.Red st next_valid_bing
  else <span data-count="310">i</span>f (<span data-count="310">n</span>ame = ("Shi", 1) || <span data-count="299">n</span>ame = ("Shi", 2))
  then <span data-count="28">m</span>ove_new_state nextpos name Board.Red st next_valid_shi_red
  else <span data-count="282">i</span>f name = ("Shuai", 1)
  then <span data-count="16">m</span>ove_new_state nextpos name Board.Red st next_valid_shuai
  else <span data-count="266">i</span>f (<span data-count="266">n</span>ame = ("Xiang", 1) || <span data-count="259">n</span>ame = ("Xiang", 2))
  then <span data-count="13">m</span>ove_new_state nextpos name Board.Red st next_valid_xiang_red
  else <span data-count="253">i</span>f (<span data-count="253">n</span>ame = ("Ma", 1)||<span data-count="253">n</span>ame = ("Ma", 2))
  then <span data-count="41">m</span>ove_new_state nextpos name Board.Red st next_valid_ma_red
  else <span data-count="212">i</span>f (<span data-count="212">n</span>ame = ("Che", 1) || <span data-count="170">n</span>ame = ("Che", 2))
  then <span data-count="119">m</span>ove_new_state nextpos name Board.Red st next_valid_che_red
  else <span data-count="93">i</span>f (<span data-count="93">n</span>ame = ("Pao", 1) || <span data-count="64">n</span>ame = ("Pao", 2))
  then <span data-count="93">m</span>ove_new_state nextpos name Board.Red st next_valid_pao_red
  else <span data-count="0">I</span>llegal

(** [move_black nextpos name st] is [r] if attempting to move a chess [name] 
    with color Black to [nextpos]. If the [name] is not a valid chess name, it 
    is [Illegal]. If the [nextpos] is not a valid next position, it is 
    [Illegal]. Otherwise, it is [Legal st']. 
    This is a helper function for [move nextpos name color b st] *)
let move_black nextpos name st = 
  <span data-count="440">i</span>f (<span data-count="440">f</span>st name = "Zu" &amp;&amp; <span data-count="107">(</span><span data-count="107">s</span>nd name = 1 || <span data-count="176">s</span>nd name = 2 || <span data-count="104">s</span>nd name = 3 || 
                          <span data-count="34">s</span>nd name = 4 || <span data-count="9">s</span>nd name =5) )
  then <span data-count="107">m</span>ove_new_state nextpos name Board.Black st next_valid_zu
  else <span data-count="333">i</span>f (<span data-count="333">n</span>ame = ("Shi", 3) || <span data-count="309">n</span>ame = ("Shi", 4))
  then <span data-count="27">m</span>ove_new_state nextpos name Board.Black st next_valid_shi_black
  else <span data-count="306">i</span>f name = ("Jiang", 1) 
  then <span data-count="21">m</span>ove_new_state nextpos name Board.Black st next_valid_jiang
  else <span data-count="285">i</span>f (<span data-count="285">n</span>ame = ("Xiang", 3) || <span data-count="278">n</span>ame = ("Xiang", 4))
  then <span data-count="12">m</span>ove_new_state nextpos name Board.Black st next_valid_xiang_black
  else <span data-count="273">i</span>f (<span data-count="273">n</span>ame = ("Ma", 3) || <span data-count="233">n</span>ame = ("Ma", 4))
  then <span data-count="40">m</span>ove_new_state nextpos name Board.Black st next_valid_ma_black
  else <span data-count="233">i</span>f (<span data-count="233">n</span>ame = ("Che", 3) || <span data-count="186">n</span>ame = ("Che", 4))
  then <span data-count="164">m</span>ove_new_state nextpos name Board.Black st next_valid_che_black
  else <span data-count="69">i</span>f (<span data-count="69">n</span>ame = ("Pao", 3) || <span data-count="34">n</span>ame = ("Pao", 4))
  then <span data-count="69">m</span>ove_new_state nextpos name Board.Black st next_valid_pao_black
  else <span data-count="0">I</span>llegal 

let move nextpos name color b st =
  <span data-count="851">c</span>heck_color_name color name st;
  <span data-count="851">i</span>f color = Board.Red then <span data-count="411">m</span>ove_red nextpos name st 
  else <span data-count="440">m</span>ove_black nextpos name st 
</pre>
      </div>
    </div>
    <div id="footer">Generated on 2019-12-09 23:16:23 by <a href="https://github.com/aantron/bisect_ppx">Bisect_ppx</a> 1.4.1</div>
    <script src="coverage.js"></script>
  </body>
</html>
